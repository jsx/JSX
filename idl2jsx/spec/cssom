<!DOCTYPE html><html lang="en-US"><head>
  <meta charset="utf-8">
  <title>CSS Object Model (CSSOM)</title>
  <link href="cssom.css" rel="stylesheet">
  <link href="http://www.w3.org/StyleSheets/TR/W3C-ED" rel="stylesheet">
 </head>
 <body class="draft">
  <div class="head">
   
<!--begin-logo-->
<p><a href="http://www.w3.org/"><img alt="W3C" height="48" src="http://www.w3.org/Icons/w3c_home" width="72"></a></p>
<!--end-logo-->

   <!-- ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
   <!-- ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->

   <h1 id="cssom">CSS Object Model (CSSOM)</h1>

   <!-- ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->

   <h2 class="no-num no-toc" id="w3c-doctype">Editor's Draft 28 October 2012</h2>

   <dl>

    <dt>This Version:</dt>
    <dd class="dontpublish"><a href="http://dvcs.w3.org/hg/csswg/raw-file/tip/cssom/Overview.html">http://dvcs.w3.org/hg/csswg/raw-file/tip/cssom/Overview.html</a></dd>
    <dt class="dontpublish">Participate:</dt>
    <dd class="dontpublish"><a href="mailto:www-style@w3.org?subject==%5Bcssom%5D%20">www-style@w3.org</a> (<a href="http://lists.w3.org/Archives/Public/www-style/">archives</a>)</dd>
    <dd class="dontpublish"><a href="https://www.w3.org/Bugs/Public/enter_bug.cgi?product=CSS&amp;component=CSSOM">File a bug</a></dd>
    <dd class="dontpublish"><a href="irc://irc.w3.org/css">IRC: #css on W3C</a></dd>

    <dt class="dontpublish">Previous Version:</dt>
    <dd class="dontpublish"><a href="http://www.w3.org/TR/2011/WD-cssom-20110712/">http://www.w3.org/TR/2011/WD-cssom-20110712/</a></dd>
    <dd class="dontpublish"><a href="http://www.w3.org/TR/2000/REC-DOM-Level-2-Style-20001113/">http://www.w3.org/TR/2000/REC-DOM-Level-2-Style-20001113/</a></dd>

    <dt>Editors:</dt>
    <dd><a href="http://www.w3.org/wiki/User:Gadams">Glenn Adams</a>
    (<a href="http://www.cox.com/">Cox Communications, Inc.</a>)
    &lt;<a href="mailto:glenn.adams@cox.com">glenn.adams@cox.com</a>&gt;</dd>
    <dd><a>Shane Stephens</a>
    (<a href="http://www.google.com/">Google, Inc.</a>)
    &lt;<a href="mailto:shans@google.com">shans@google.com</a>&gt;</dd>

    <dt>Previous Editor:</dt>
    <dd><a href="http://annevankesteren.nl/">Anne van Kesteren</a>
    (<a href="http://www.opera.com/">Opera Software ASA</a>)
    &lt;<a href="mailto:annevk@opera.com">annevk@opera.com</a>&gt;</dd>
   </dl>

   
<!--begin-copyright-->
<p class="copyright"><a href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> © 2012 <a href="http://www.w3.org/"><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>®</sup> (<a href="http://www.csail.mit.edu/"><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>, <a href="http://www.ercim.eu/"><abbr title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>, <a href="http://www.keio.ac.jp/">Keio</a>), All Rights Reserved. W3C <a href="http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>, <a href="http://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and <a href="http://www.w3.org/Consortium/Legal/copyright-documents">document use</a> rules apply.</p>
<!--end-copyright-->

  </div>

  <hr class="top">

  <!-- ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->

  <h2 class="no-num no-toc" id="abstract">Abstract</h2>

  <p>CSSOM defines APIs (including generic parsing and serialization rules)
  for Media Queries, Selectors, and of course CSS itself.</p>

  <!-- ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->

  <h2 class="no-num no-toc" id="sotd">Status of this Document</h2>

  <p>This is a public copy of the editors' draft. It is provided for discussion only and may change at any moment.
  Its publication here does not imply endorsement of its contents by W3C or by the CSS Working Group. Don't cite
  this document other than as work in progress.</p>

  <p class="note">Implementers should note well that this specification is an ongoing effort to sort out
  what has been widely implemented and deployed from <a href="#refsDOM2STYLE">[DOM2STYLE]</a> as well as common extensions thereto, some details
  of which are currently interoperable and others which are not currently interoperable. As this specification moves
  forward, it is hoped that these differences will be resolved and an unambiguous and adequate consensus-based
  specification will emerge.</p>

  <p><em>This section describes the status of this document at the time of
  its publication. Other documents may supersede this document. A list of
  current W3C publications and the latest revision of this technical report
  can be found in the
  <a href="http://www.w3.org/TR/">W3C technical reports index at http://www.w3.org/TR/.</a></em>

  <p class="dontpublish">This is the 28 October 2012 Editor's Draft of CSSOM. Please send comments to
  <a href="mailto:www-style@w3.org?subject=%5Bcssom%5D%20">www-style@w3.org</a>
  (<a href="http://lists.w3.org/Archives/Public/www-style/">archived</a>)
  with <samp>[cssom]</samp> at the start of the subject line.

  <p>This document was produced by a group operating under the
  <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/">5 February 2004 W3C Patent Policy</a>.
  W3C maintains a
  <a href="http://www.w3.org/2004/01/pp-impl/32061/status" rel="disclosure">public list of any patent disclosures</a>
  made in connection with the deliverables of the group; that page also
  includes instructions for disclosing a patent. An individual who has
  actual knowledge of a patent which the individual believes contains
  <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#def-essential">Essential Claim(s)</a>
  must disclose the information in accordance with
  <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#sec-Disclosure">section 6 of the W3C Patent Policy</a>.</p>

  <!-- ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->

  <h2 class="no-num no-toc" id="toc">Table of Contents</h2>

  
<!--begin-toc-->
<ol class="toc">
 <li><a href="#introduction"><span class="secno">1 </span>Introduction</a></li>
 <li><a href="#conformance"><span class="secno">2 </span>Conformance</a></li>
 <li><a href="#terminology"><span class="secno">3 </span>Terminology</a>
  <ol class="toc">
   <li><a href="#common-serializing-idioms"><span class="secno">3.1 </span>Common Serializing Idioms</a></ol></li>
 <li><a href="#media-queries"><span class="secno">4 </span>Media Queries</a>
  <ol class="toc">
   <li><a href="#parsing-media-queries"><span class="secno">4.1 </span>Parsing Media Queries</a></li>
   <li><a href="#serializing-media-queries"><span class="secno">4.2 </span>Serializing Media Queries</a>
    <ol class="toc">
     <li><a href="#serializing-media-feature-values"><span class="secno">4.2.1 </span>Serializing Media Feature Values</a></ol></li>
   <li><a href="#comparing-media-queries"><span class="secno">4.3 </span>Comparing Media Queries</a></li>
   <li><a href="#the-medialist-interface"><span class="secno">4.4 </span>The <code>MediaList</code> Interface</a></ol></li>
 <li><a href="#selectors"><span class="secno">5 </span>Selectors</a>
  <ol class="toc">
   <li><a href="#parsing-selectors"><span class="secno">5.1 </span>Parsing Selectors</a></li>
   <li><a href="#serializing-selectors"><span class="secno">5.2 </span>Serializing Selectors</a></ol></li>
 <li><a href="#css"><span class="secno">6 </span>CSS</a>
  <ol class="toc">
   <li><a href="#css-style-sheets"><span class="secno">6.1 </span>CSS Style Sheets</a>
    <ol class="toc">
     <li><a href="#the-stylesheet-interface"><span class="secno">6.1.1 </span>The <code>StyleSheet</code> Interface</a></li>
     <li><a href="#the-cssstylesheet-interface"><span class="secno">6.1.2 </span>The <code>CSSStyleSheet</code> Interface</a></ol></li>
   <li><a href="#style-sheet-collections"><span class="secno">6.2 </span>Style Sheet Collections</a>
    <ol class="toc">
     <li><a href="#the-http-default-style-header"><span class="secno">6.2.1 </span>The HTTP <code>Default-Style</code> Header</a></li>
     <li><a href="#the-stylesheetlist-sequence"><span class="secno">6.2.2 </span>The <code>StyleSheetList</code> Sequence</a></li>
     <li><a href="#extensions-to-the-document-interface"><span class="secno">6.2.3 </span>Extensions to the <code>Document</code> Interface</a></li>
     <li><a href="#interaction-with-the-user-interface"><span class="secno">6.2.4 </span>Interaction with the User Interface</a>
      <ol class="toc">
       <li><a href="#persisting-the-selected-style-sheet-set"><span class="secno">6.2.4.1 </span>Persisting the selected style sheet set</a></ol></li>
     <li><a href="#examples"><span class="secno">6.2.5 </span>Examples</a></ol></li>
   <li><a href="#style-sheet-association"><span class="secno">6.3 </span>Style Sheet Association</a>
    <ol class="toc">
     <li><a href="#the-linkstyle-interface"><span class="secno">6.3.1 </span>The <code>LinkStyle</code> Interface</a></li>
     <li><a href="#requirements-on-specifications"><span class="secno">6.3.2 </span>Requirements on specifications</a></li>
     <li><a href="#requirements-on-user-agents-implementing-the-xml-stylesheet-processing-instruction"><span class="secno">6.3.3 </span>Requirements on User Agents Implementing the
  <span><code>xml-stylesheet</code> processing instruction</span></a></li>
     <li><a href="#requirements-on-user-agents-implementing-the-http-link-header"><span class="secno">6.3.4 </span>Requirements on User Agents Implementing the HTTP
  <code>Link</code> Header</a></ol></li>
   <li><a href="#css-rules"><span class="secno">6.4 </span>CSS Rules</a>
    <ol class="toc">
     <li><a href="#the-cssrulelist-sequence"><span class="secno">6.4.1 </span>The <code>CSSRuleList</code> Sequence</a></li>
     <li><a href="#the-cssrule-interface"><span class="secno">6.4.2 </span>The <code>CSSRule</code> Interface</a></li>
     <li><a href="#the-cssstylerule-interface"><span class="secno">6.4.3 </span>The <code>CSSStyleRule</code> Interface</a></li>
     <li><a href="#the-csscharsetrule-interface"><span class="secno">6.4.4 </span>The <code>CSSCharsetRule</code> Interface</a></li>
     <li><a href="#the-cssimportrule-interface"><span class="secno">6.4.5 </span>The <code>CSSImportRule</code> Interface</a></li>
     <li><a href="#the-cssmediarule-interface"><span class="secno">6.4.6 </span>The <code>CSSMediaRule</code> Interface</a></li>
     <li><a href="#the-cssfontfacerule-interface"><span class="secno">6.4.7 </span>The <code>CSSFontFaceRule</code> Interface</a></li>
     <li><a href="#the-csspagerule-interface"><span class="secno">6.4.8 </span>The <code>CSSPageRule</code> Interface</a></li>
     <li><a href="#the-cssnamespacerule-interface"><span class="secno">6.4.9 </span>The <code>CSSNamespaceRule</code> Interface</a></ol></li>
   <li><a href="#css-declaration-blocks"><span class="secno">6.5 </span>CSS Declaration Blocks</a>
    <ol class="toc">
     <li><a href="#the-cssstyledeclaration-interface"><span class="secno">6.5.1 </span>The <code>CSSStyleDeclaration</code> Interface</a></ol></li>
   <li><a href="#css-values"><span class="secno">6.6 </span>CSS Values</a>
    <ol class="toc">
     <li><a href="#parsing-css-values"><span class="secno">6.6.1 </span>Parsing CSS Values</a></li>
     <li><a href="#serializing-css-values"><span class="secno">6.6.2 </span>Serializing CSS Values</a>
      <ol class="toc">
       <li><a href="#examples-0"><span class="secno">6.6.2.1 </span>Examples</a></ol></ol></ol></li>
 <li><a href="#dom-access-to-css-declaration-blocks"><span class="secno">7 </span>DOM Access to CSS Declaration Blocks</a>
  <ol class="toc">
   <li><a href="#the-elementcssinlinestyle-interface"><span class="secno">7.1 </span>The <code>ElementCSSInlineStyle</code> Interface</a></li>
   <li><a href="#extensions-to-the-window-interface"><span class="secno">7.2 </span>Extensions to the <code>Window</code> Interface</a></ol></li>
 <li><a href="#resolved-values"><span class="secno">8 </span>Resolved Values</a></li>
 <li><a href="#iana-considerations"><span class="secno">9 </span>IANA Considerations</a>
  <ol class="toc">
   <li><a href="#default-style"><span class="secno">9.1 </span><code>Default-Style</code></a></ol></li>
 <li><a class="no-num" href="#references">References</a>
  <ol class="toc">
   <li><a class="no-num" href="#normative-references">Normative references</a></li>
   <li><a class="no-num" href="#informative-references">Informative references</a></ol></li>
 <li><a class="no-num" href="#changes">Change History</a>
  <ol class="toc">
   <li><a class="no-num" href="#changes-from-dom2">Changes From DOM-2 Style</a></ol></li>
 <li><a class="no-num" href="#acknowledgments">Acknowledgments</a></ol>
<!--end-toc-->

  <!-- ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->

  <h2 id="introduction"><span class="secno">1 </span>Introduction</h2>

  <p>This document formally specifies the core features of the CSS Object Model (CSSOM). Other documents in the CSSOM family of specifications
  as well as other CSS related specifications define extensions to these core features.</p>

  <p>The core features of the CSSOM are oriented towards providing basic capabilities to author-defined scripts to permit access to
  and manipulation of style related state information and processes.</p>

  <p>The features defined below are fundamentally based on prior specifications of the W3C DOM Working Group, primarily
  <a href="#refsDOM2STYLE">[DOM2STYLE]</a>. The purposes of the present document are (1) to improve on that prior work by providing
  more technical specificity (so as to improve testability and interoperability), (2) to deprecate or remove certain less-widely implemented
  features no longer considered to be essential in this context, and (3) to newly specify certain extensions that have been
  or expected to be widely implemented.</p>

  <p>A full list of the changes to API signatures can be found in <a href="#changes-from-dom2"><cite>Changes from DOM-2 Style</cite></a>.</p>

  <!-- ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->

  <h2 id="conformance"><span class="secno">2 </span>Conformance</h2>

  <p>All diagrams, examples, and notes in this specification are
  non-normative, as are all sections explicitly marked non-normative.
  Everything else in this specification is normative.

  <p>The key words "MUST", "MUST NOT", "REQUIRED", <!--"SHALL", "SHALL
  NOT",--> "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and
  "OPTIONAL" in the normative parts of this document are to be
  interpreted as described in RFC2119. For readability, these words do
  not appear in all uppercase letters in this specification.
  <a href="#refsRFC2119">[RFC2119]</a>

  <p>Requirements phrased in the imperative as part of algorithms
  (such as "strip any leading space characters" or "return false and
  terminate these steps") are to be interpreted with the meaning of the
  key word ("must", "should", "may", etc) used in introducing the
  algorithm.

  <p>Conformance requirements phrased as algorithms or specific steps
  may be implemented in any manner, so long as the end result is
  equivalent. (In particular, the algorithms defined in this
  specification are intended to be easy to follow, and not intended to
  be performant.)

  <p id="hardwareLimitations">User agents may impose
  implementation-specific limits on otherwise unconstrained inputs,
  e.g. to prevent denial of service attacks, to guard against running
  out of memory, or to work around platform-specific limitations.

  <p>When a method or an attribute is said to call another method or attribute, the user agent must invoke its internal API for that attribute or method so that e.g. the author can't change the behavior by overriding attributes or methods with custom properties or functions in ECMAScript.

  <p>Unless otherwise stated, string comparisons are done in a
  <a class="external" href="http://dom.spec.whatwg.org/#case-sensitive">case-sensitive</a> manner.

  <!-- ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->

  <h2 id="terminology"><span class="secno">3 </span>Terminology</h2>

  <p>This specification employs certain terminology from the following documents:
  <cite>DOM4</cite>,
  <cite>HTML</cite>,
  <cite>Associating Style Sheets with XML documents</cite>
  and
  <cite>XML</cite>
  <a href="#refsDOM">[DOM]</a>
  <a href="#refsHTML">[HTML]</a>
  <a href="#refsXMLSS">[XMLSS]</a>
  <a href="#refsXML">[XML]</a>.

  <p>When this specification talks about object
  <code><var>A</var></code> where <code><var>A</var></code> is actually an interface, it generally means an object implementing interface
  <code><var>A</var></code>.</p>

  <p>The term <dfn id="whitespace">whitespace</dfn> is used as defined in <a href="#refsCSS">[CSS]</a>.

  <p>The terms <dfn id="set">set</dfn> and <dfn id="clear">clear</dfn> to refer to the <code>true</code> and
  <code>false</code> values of binary flags or variables, respectively. These terms are also used as verbs in which case they refer to
  mutating some value to make it <code>true</code> or <code>false</code>, respectively.</p>

  <!-- ........................................................................................................................ -->
  <!-- ........................................................................................................................ -->

  <h3 id="common-serializing-idioms"><span class="secno">3.1 </span>Common Serializing Idioms</h3>

  <p>To <dfn id="escape-a-character">escape a character</dfn> means to create a string of
  "<code>\</code>" (U+005C), followed by the character.</p>

  <p>To <dfn id="escape-a-character-as-code-point">escape a character as code point</dfn> means to create a
  string of "<code>\</code>" (U+005C), followed by the Unicode code point as
  the smallest possible number of hexadecimal digits in the range 0-9 a-f
  (U+0030 to U+0039 and U+0061 to U+0066) to represent the code point in
  base 16, followed by a single SPACE (U+0020).</p>

  <p>To <dfn id="serialize-an-identifier">serialize an identifier</dfn> means to create a string represented
  by the concatenation of, for each character of the identifier:</p>

  <ul>
   <li>If the character is NULL (U+0000), then <a class="external" href="http://dom.spec.whatwg.org/#concept-throw" title="concept-throw">throw</a> an
   <code class="external"><a href="http://dom.spec.whatwg.org/#invalidcharactererror">InvalidCharacterError</a></code> exception and terminate these steps.</li>
   <li>If the character is in the range [\1-\1f] (U+0001 to U+001F) or
   [\7f-\9f] (U+007F to U+009F), then the character
   <a href="#escape-a-character-as-code-point" title="escape a character as code point">escaped as code point</a>.</li>
   <li>If the character is the first character and is in the range [0-9]
   (U+0030 to U+0039), then the character
   <a href="#escape-a-character-as-code-point" title="escape a character as code point">escaped as code point</a>.</li>
   <li>If the character is the second character and is in the range [0-9]
   (U+0030 to U+0039) and the first character is a "<code>-</code>"
   (U+002D), then the character
   <a href="#escape-a-character-as-code-point" title="escape a character as code point">escaped as code point</a>.</li>
   <li>If the character is the second character and is "<code>-</code>"
   (U+002D) and the first character is "<code>-</code>" as well, then the
   <a href="#escape-a-character" title="escape a character">escaped</a> character.</li>
   <li>If the character is not handled by one of the above rules and is
   greater than or equal to U+0080, is "<code>-</code>" (U+002D) or
   "<code>_</code>" (U+005F), or is in one of the ranges [0-9] (U+0030 to
   U+0039), [A-Z] (U+0041 to U+005A), or [a-z] (U+0061 to U+007A), then the character
   itself.</li>
   <li>Otherwise, the <a href="#escape-a-character" title="escape a character">escaped</a>
   character.</li>
  </ul>

  <p>To <dfn id="serialize-a-string">serialize a string</dfn> means to create a string represented
  by '<code>"</code>' (U+0022), followed by the result of applying the rules
  below to each character of the given string, followed by
  '<code>"</code>' (U+0022):</p>

  <ul>
   <li>If the character is NULL (U+0000), then <a class="external" href="http://dom.spec.whatwg.org/#concept-throw" title="concept-throw">throw</a> an
   <code class="external"><a href="http://dom.spec.whatwg.org/#invalidcharactererror">InvalidCharacterError</a></code> exception and terminate these steps.</li>
   <li>If the character is in the range [\1-\1f] (U+0001 to U+001F) or [\7f-\9f] (U+007F to
   U+009F), the character <a href="#escape-a-character-as-code-point" title="escape a character as code point">escaped as code point</a>.</li>
   <li>If the character is '<code>"</code>' (U+0022) or '<code>\</code>'
   (U+005C), the <a href="#escape-a-character" title="escape a character">escaped</a> character.</li>
   <li>Otherwise, the character itself.</li>
  </ul>

  <p class="note">"<code>'</code>" (U+0027) is not escaped because strings
  are always serialized with '<code>"</code>' (U+0022).</p>

  <p>To <dfn id="serialize-a-url">serialize a URL</dfn> means to create a string represented by
  "<code>url(</code>", followed by the
  <a href="#serialize-a-string" title="serialize a string">string escaped</a> value of the given
  string, followed by "<code>)</code>".</p>

  <p>To <dfn id="serialize-a-comma-separated-list">serialize a comma-separated list</dfn> concatenate all items of
  the list in list order while separating them by "<code>, </code>", i.e.,
  COMMA (U+002C) followed by a single SPACE (U+0020).</p>

  <p>To <dfn id="serialize-a-whitespace-separated-list">serialize a whitespace-separated list</dfn> concatenate all
  items of the list in list order while separating them by "<code> </code>", i.e.,
  a single SPACE (U+0020).</p>

  <p class="note">When serializing a list according to the above rules,
  extraneous whitespace is not inserted prior to the first item or subsequent to
  the last item. Unless otherwise specified, an empty list is serialized as the
  empty string.</p>

  <!-- ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->

  <h2 id="media-queries"><span class="secno">4 </span>Media Queries</h2>

  <p>Media queries are defined by the Media Queries specification. This
  section defines various concepts around media queries, including their API
  and serialization form.</p>

  <!-- XXX ref -->

  <!-- ........................................................................................................................ -->
  <!-- ........................................................................................................................ -->

  <h3 id="parsing-media-queries"><span class="secno">4.1 </span>Parsing Media Queries</h3>

  <p>To
  <dfn id="parse-a-media-query-list">parse a media query list</dfn> for a
  given string <var>s</var> into a media query list is defined in
  the Media Queries specification. Return the list of one or more media
  queries that the algorithm defined there gives.</p> <!-- XXX ref -->

  <p class="note">A media query that ends up being "ignored" will turn
  into "<code>not all</code>".</p>

  <p>To
  <dfn id="parse-a-media-query">parse a media query</dfn> for a given string
  <var>s</var> means to follow the
  <a href="#parse-a-media-query-list">parse a media query list</a> steps and return <code>null</code> if more
  than one media query is returned or a media query if a
  single media query is returned.</p>

  <p class="note">Again, a media query that ends up being "ignored" will
  turn into "<code>not all</code>".</p>

  <!-- ........................................................................................................................ -->

  <h3 id="serializing-media-queries"><span class="secno">4.2 </span>Serializing Media Queries</h3>

  <p>To
  <dfn id="serialize-a-media-query-list">serialize a media query list</dfn>
  run these steps:</p>

  <ol>
   <li><p>If the media query list is empty return the empty string and
   terminate these steps.</li>

   <li><p><a href="#serialize-a-media-query" title="serialize a media query">Serialize</a> each
   media query in the list of media queries, sort them in lexicographical
   order, and then
   <a href="#serialize-a-comma-separated-list" title="serialize a comma-separated list">serialize</a> the
   list.</li>
  </ol>

  <p>To
  <dfn id="serialize-a-media-query">serialize a media query</dfn> let
  <var>s</var> be the empty string, run the steps below, and
  finally return <var>s</var>:</p>

  <ol>
   <li><p>If the media query is negated append "<code>not</code>", followed
   by a single SPACE (U+0020), to <var>s</var>.</li>

   <li><p>Let <var>type</var> be the media type of the media query,
   <a href="#serialize-an-identifier" title="serialize an identifier">escaped</a> and
   <a class="external" href="http://dom.spec.whatwg.org/#converted-to-ascii-lowercase">converted to ASCII lowercase</a>.</li>

   <li><p>If the media query does not contain media features append
   <var>type</var>, to <var>s</var>,
   then return <var>s</var> and terminate this algorithm.</li>

   <li><p>If <var>type</var> is not "<code>all</code>" or if the
   media query is negated append <var>type</var>, followed by a
   single SPACE (U+0020), followed by "<code>and</code>", followed by a single SPACE
   (U+0020), to <var>s</var>.</li>

   <li><p>Sort the media features in lexicographical order.</li>

   <li>
    <p>Then, for each media feature:</p>

    <ol>
     <li>Append a "<code>(</code>" (U+0028), followed by the media feature
     name, <a class="external" href="http://dom.spec.whatwg.org/#converted-to-ascii-lowercase">converted to ASCII lowercase</a>,
     to <var>s</var>.<p></li>

     <li><p>If a value is given append a "<code>:</code>" (U+003A), followed
     by a single SPACE (U+0020), followed by the
     <a href="#serialize-a-media-feature-value" title="serialize a media feature value">serialized media feature value</a>,
     to <var>s</var>.</li>

     <li><p>Append a "<code>)</code>" (U+0029) to
     <var>s</var>.</li>

     <li><p>If this is not the last media feature append a single SPACE (U+0020),
     followed by "<code>and</code>", followed by a single SPACE (U+0020), to
     <var>s</var>.</li>
    </ol>
   </li>
  </ol>

  <div class="example">
   <p>Here are some examples of input (first column) and output (second
   column):</p>

   <table>
    <thead>
     <tr><th>Input<th>Output
    <tbody>
     <tr>
      <td><code>not screen and (min-WIDTH:5px) AND (max-width:40px  )</code>
      <td><code>not screen and (max-width: 40px) and (min-width: 5px)</code>
     <tr>
      <td><code>all and (color) and (color)</code>
      <td><code>(color)</code>
   </table>
  </div>


  <!-- ........................................................................................................................ -->

  <h4 id="serializing-media-feature-values"><span class="secno">4.2.1 </span>Serializing Media Feature Values</h4>

  <p class="issue">This should probably be done in terms of mapping it to
  serializing CSS values as media features are defined in terms of CSS
  values after all.</p>

  <p>To <dfn id="serialize-a-media-feature-value">serialize a media feature value</dfn>
  named <var>v</var> locate <var>v</var> in the first
  column of the table below and use the serialization format described in
  the second column:</p>

  <table>
   <tr>
    <th>Media Feature
    <th>Serialization
   <tr>
    <td><code>width</code>
    <td>...
   <tr>
    <td><code>height</code>
    <td>...
   <tr>
    <td><code>device-width</code>
    <td>...
   <tr>
    <td><code>device-height</code>
    <td>...
   <tr>
    <td><code>orientation</code>
    <td>
     <p>If the value is `<code>portrait</code>`: "<code>portrait</code>".</p>
     <p>If the value is `<code>landscape</code>`: "<code>landscape</code>".</p>
   <tr>
    <td><code>aspect-ratio</code>
    <td>...
   <tr>
    <td><code>device-aspect-ratio</code>
    <td>...
   <tr>
    <td><code>color</code>
    <td>...
   <tr>
    <td><code>color-index</code>
    <td>...
   <tr>
    <td><code>monochrome</code>
    <td>...
   <tr>
    <td><code>resolution</code>
    <td>...
   <tr>
    <td><code>scan</code>
    <td>
     <p>If the value is `<code>progressive</code>`: "<code>progressive</code>".</p>
     <p>If the value is `<code>interlace</code>`: "<code>interlace</code>".</p>
   <tr>
    <td><code>grid</code>
    <td>...
  </table>

  <p>Other specifications can extend this table and vendor-prefixed media
  features can have custom serialization formats as well.</p>

  <!-- ........................................................................................................................ -->
  <!-- ........................................................................................................................ -->

  <h3 id="comparing-media-queries"><span class="secno">4.3 </span>Comparing Media Queries</h3>

  <p>To
  <dfn id="compare-media-queries">compare media queries</dfn>
  <var>m1</var> and <var>m2</var> means to
  <a href="#serialize-a-media-query" title="serialize a media query">serialize</a> them both and
  return true if they are a
  <a class="external" href="http://dom.spec.whatwg.org/#case-sensitive">case-sensitive</a> match and false if they
  are not.</p>

  <!-- ........................................................................................................................ -->
  <!-- ........................................................................................................................ -->

  <h3 id="the-medialist-interface"><span class="secno">4.4 </span>The <code>MediaList</code> Interface</h3>

  <p>An object that implements the <a class="idlType" href="#widl-def-MediaList"><code>MediaList</code></a> interface has an associated <dfn id="collection-of-media-queries">collection of media queries</dfn>.</p>
<pre class="idl"><span class="idlInterface" id="widl-def-MediaList">[Constructor(DOMString text)]
interface <span class="idlInterfaceID">MediaList</span> {
<span class="idlAttribute">    stringifier attribute <span class="idlAttrType"><a>DOMString</a></span> <span class="idlAttrName"><a href="#widl-MediaList-mediaText">mediaText</a></span>;</span>
<span class="idlAttribute">    readonly attribute <span class="idlAttrType"><a>unsigned long</a></span> <span class="idlAttrName"><a href="#widl-MediaList-length">length</a></span>;</span>
<span class="idlMethod">    <span class="idlMethType"><a>DOMString</a></span> <span class="idlMethName"><a href="#widl-MediaList-item-DOMString-unsigned-long-index">item</a></span> (<span class="idlParam"><span class="idlParamType"><a>unsigned long</a></span> <span class="idlParamName">index</span></span>);</span>
<span class="idlMethod">    <span class="idlMethType"><a>void</a></span> <span class="idlMethName"><a href="#widl-MediaList-appendMedium-void-DOMString-medium">appendMedium</a></span> (<span class="idlParam"><span class="idlParamType"><a>DOMString</a></span> <span class="idlParamName">medium</span></span>);</span>
<span class="idlMethod">    <span class="idlMethType"><a>void</a></span> <span class="idlMethName"><a href="#widl-MediaList-deleteMedium-void-DOMString-medium">deleteMedium</a></span> (<span class="idlParam"><span class="idlParamType"><a>DOMString</a></span> <span class="idlParamName">medium</span></span>);</span>
};</span></pre>
<dl class="constructors">
<dt class="constructor" id="widl-MediaList-DOMString-text">
<code>MediaList</code> (<span class="idlParam"><span class="idlParamType"><a>DOMString</a></span> <span class="idlParamName">text</span></span>)</dt>
<dd>
<p>To <dfn id="create-a-medialist-object">create a <code>MediaList</code> object</dfn> from a string <var>text</var>, run these steps:</p>   <ol>    <li><p>Create a new <code>MediaList</code> object.</li>    <li><p>Set its <span title="dom-MediaList-mediaText">mediaText</span> attribute to <var>text</var>.</li>    <li><p>Return the newly created <code><code>MediaList</code></code> object.</li>   </ol></dd>
</dl>
<dl class="attributes">
<dt class="attribute" id="widl-MediaList-mediaText">
<code>mediaText</code> of type <span class="idlAttrType"><a>DOMString</a></span></dt>
<dd>
<p>The <code>mediaText</code> attribute must return a <a href="#serialize-a-media-query-list" title="serialize a media query list">serialization</a>   of the <a href="#collection-of-media-queries">collection of media queries</a>.</p>   <p>Setting the <code>mediaText</code> attribute must run these steps:   <ol>    <li><p>Empty the <a href="#collection-of-media-queries">collection of media queries</a>.</li>    <li><p>If the given value is the empty string terminate these steps.</li>    <li><p>Append all the media queries as a result of <a href="#parse-a-media-query-list" title="parse a media query list">parsing</a> the given    value to the <a href="#collection-of-media-queries">collection of media queries</a>.</li>   </ol></dd>
<dt class="attribute" id="widl-MediaList-length">
<code>length</code> of type <span class="idlAttrType"><a>unsigned long</a></span>, readonly</dt>
<dd>
<p>The <code>length</code> attribute must return the number of media queries in the <a href="#collection-of-media-queries">collection of media queries</a>.</dd>
</dl>
<dl class="methods">
<dt class="method" id="widl-MediaList-item-DOMString-unsigned-long-index">
<code>item</code> (<span class="idlParam"><span class="idlParamType"><a>unsigned long</a></span> <span class="idlParamName">index</span></span>), returns <span class="idlMethType"><a>DOMString</a></span></dt>
<dd>
<p>The <code>item</code> method must return the media query in the <a href="#collection-of-media-queries">collection of media queries</a> given by   <var>index</var>, or <code>null</code>, if <var>index</var> is greater than or equal to the number of media queries in the   <a href="#collection-of-media-queries">collection of media queries</a>.</dd>
<dt class="method" id="widl-MediaList-appendMedium-void-DOMString-medium">
<code>appendMedium</code> (<span class="idlParam"><span class="idlParamType"><a>DOMString</a></span> <span class="idlParamName">medium</span></span>), returns <span class="idlMethType"><a>void</a></span></dt>
<dd>
<p>The <code>appendMedium</code> method must run these steps:</p>   <ol>    <li><p>Let <var>m</var> be the result of <a href="#parse-a-media-query" title="parse a media query">parsing</a> the given value.</li>    <li><p>If <var>m</var> is <code>null</code> terminate these steps.</li>    <li><p>If <a href="#compare-media-queries" title="compare media queries">comparing</a> <var>m</var> with any of the media queries in the    <a href="#collection-of-media-queries">collection of media queries</a> returns true terminate these steps.</li>    <li><p>Append <var>m</var> to the <a href="#collection-of-media-queries">collection of media queries</a>.</li>   </ol></dd>
<dt class="method" id="widl-MediaList-deleteMedium-void-DOMString-medium">
<code>deleteMedium</code> (<span class="idlParam"><span class="idlParamType"><a>DOMString</a></span> <span class="idlParamName">medium</span></span>), returns <span class="idlMethType"><a>void</a></span></dt>
<dd>
<p>The <code>deleteMedium</code> method must run these steps:</p>   <ol>    <li><p>Let <var>m</var> be the result of <a href="#parse-a-media-query" title="parse a media query">parsing</a> the given value.</li>    <li><p>If <var>m</var> is <code>null</code> terminate these steps.</li>    <li><p>Remove any media query from the <a href="#collection-of-media-queries">collection of media queries</a> for which    <a href="#compare-media-queries" title="compare media queries">comparing</a> the media query with <var>m</var> returns true.</li>   </ol></dd>
</dl>


  <!-- ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->

  <h2 id="selectors"><span class="secno">5 </span>Selectors</h2>

  <p>Selectors are defined in the Selectors specification. This section
  mainly defines how to serialize them.</p> <!-- XXX ref -->

  <!-- XXX ref universal selector etc? some are in <span> some not -->

  <!-- ........................................................................................................................ -->
  <!-- ........................................................................................................................ -->

  <h3 id="parsing-selectors"><span class="secno">5.1 </span>Parsing Selectors</h3>

  <p>To
  <dfn id="parse-a-group-of-selectors">parse a group of selectors</dfn>
  means to parse the value using the <code>selectors_group</code>
  production defined in the Selectors specification and return either a
  group of selectors if parsing did not fail or <code>null</code> if parsing did
  fail.</p> <!-- XXX ref -->

  <!-- ........................................................................................................................ -->
  <!-- ........................................................................................................................ -->

  <h3 id="serializing-selectors"><span class="secno">5.2 </span>Serializing Selectors</h3>
  <!-- http://dump.testsuite.org/2009/cssom/serializing-selectors.htm -->

  <p>To
  <dfn id="serialize-a-group-of-selectors">serialize a group of selectors</dfn>
  <a href="#serialize-a-selector" title="serialize a selector">serialize</a> each selector in the
  group of selectors and then
  <a href="#serialize-a-comma-separated-list" title="serialize a comma-separated list">serialize</a> the
  group.</p>

  <p>To <dfn id="serialize-a-selector">serialize a selector</dfn> let
  <var>s</var> be the empty string, run the steps below for each
  part of the chain of the selector, and finally return
  <var>s</var>:</p>

  <ol>
   <li><p>If there is only one <span>simple selector</span> in the
   <span>sequence of simple selectors</span> which is a
   <span>universal selector</span>, append the result of
   <a href="#serialize-a-simple-selector" title="serialize a simple selector">serializing</a> the
   <span>universal selector</span> to <var>s</var>.</li>

   <li><p>Otherwise, for each <span>simple selector</span> in the
   <span>sequence of simple selectors</span> that is not a
   universal selector of which the <span>namespace prefix</span> maps to
   the null namespace (not in a namespace) or of which the
   <span>namespace prefix</span> maps to a namespace that is not the
   <span>default namespace</span>
   <a href="#serialize-a-simple-selector" title="serialize a simple selector">serialize</a> the
   <span>simple selector</span> and append the result to
   <var>s</var>.</li>

   <li><p>If this is not the last part of the chain of the selector append a
   single SPACE (U+0020), followed by the combinator
   "<code>&gt;</code>",
   "<code>+</code>", or
   "<code>~</code>"
   as appropriate, followed by another single SPACE (U+0020) if the combinator was
   not whitespace, to <var>s</var>.</li>

   <li><p>If this is the last part of the chain of the selector and there is
   a pseudo-element, append "<code>::</code>" followed by the name of the
   pseudo-class, to <var>s</var>.</li>
  </ol>


  <p>To
  <dfn id="serialize-a-simple-selector">serialize a simple selector</dfn>
  let <var>s</var> be the empty string, run the steps below, and
  finally return <var>s</var>:</p>

  <dl class="switch">
   <dt>type selector</dt>
   <dt>universal selector</dt>
   <dd>
    <ol>
     <li><p>If the <span>namespace prefix</span> maps to a namespace that is
     not the <span>default namespace</span> and is not the
     null namespace (not in a namespace) append the
     <a href="#serialize-an-identifier" title="serialize an identifier">escaped</a>
     <span>namespace prefix</span>, followed by a "<code>|</code>" (U+007C)
     to <var>s</var>.</li>

     <li><p>If the <span>namespace prefix</span> maps to a namespace that is
     the null namespace (not in a namespace) append
     "<code>|</code>" (U+007C) to <var>s</var>.</li>
     <!-- This includes |* -->

     <li><p>If this is a type selector append the
     <a href="#serialize-an-identifier" title="serialize an identifier">escaped</a> element name to
     <var>s</var>.</li>

     <li><p>If this is a universal selector append "<code>*</code>" (U+002A)
     to <var>s</var>.</li>
    </ol>
   </dd>

   <dt>attribute selector</dt>
   <dd>
    <ol>
     <li><p>Append "<code>[</code>" (U+005B) to
     <var>s</var>.</li>

     <li><p>If the <span>namespace prefix</span> maps to a namespace that is
     not the null namespace (not in a namespace) append the
     <a href="#serialize-an-identifier" title="serialize an identifier">escaped</a>
     <span>namespace prefix</span>, followed by a "<code>|</code>" (U+007C)
     to <var>s</var>.</li>

     <li><p>If the <span>namespace prefix</span> maps to a namespace that is
     the null namespace (not in a namespace) append
     "<code>|</code>" (U+007C) to <var>s</var>.</li>
     <!-- This includes |* -->

     <li><p>Append the <a href="#serialize-an-identifier" title="serialize an identifier">escaped</a>
     attribute name to <var>s</var>.</li>

     <li><p>If there is an attribute value specified, append
     "<code>=</code>",
     "<code>~=</code>",
     "<code>|=</code>",
     "<code>^=</code>",
     "<code>$=</code>", or
     "<code>*=</code>"
     as appropriate (depending on the type of attribute selector), followed
     by the <a href="#serialize-a-string" title="serialize a string">string escaped</a>
     attribute value, to <var>s</var>.</li>

     <li><p>Append "<code>]</code>" (U+005D) to
     <var>s</var>.</li>
    </ol>
   </dd>

   <dt>class selector</dt>
   <dd><p>Append a "<code>.</code>" (U+002E), followed by the
   <a href="#serialize-an-identifier" title="serialize an identifier">escaped</a> class name to
   <var>s</var>.</dd>

   <dt>ID selector</dt>
   <dd><p>Append a "<code>#</code>" (U+0023), followed by the
   <a href="#serialize-an-identifier" title="serialize an identifier">escaped</a> ID to
   <var>s</var>.</dd>

   <dt>pseudo-class</dt>
   <dd>
    <p>If the pseudo-class does not accept arguments append
    "<code>:</code>" (U+003A), followed by the name of the pseudo-class, to
    <var>s</var>.</p>

    <p>Otherwise, append "<code>:</code>" (U+003A), followed by the name of
    the pseudo-class, followed by "<code>(</code>" (U+0028), followed by the
    value of the pseudo-class argument determined as per below, followed by
    "<code>)</code>" (U+0029), to <var>s</var>.</p>

    <dl class="switch">
     <dt><code>:lang()</code></dt>
     <dd><p>The <a href="#serialize-an-identifier" title="serialize an identifier">escaped</a>
     value.</dd>

     <dt><code>:nth-child()</code></dt>
     <dt><code>:nth-last-child()</code></dt>
     <dt><code>:nth-of-type()</code></dt>
     <dt><code>:nth-last-of-type()</code></dt>
     <dd>
      <ol>
       <li><p>If the value is odd let the value be
       "<code>2n+1</code>".</li>

       <li><p>If the value is even let the value be
       "<code>2n</code>".</li>

       <li><p>If <var>a</var> is zero let the value be
       <var>b</var>
       <a href="#serialize-a-css-value-component" title="serialize a CSS component value">serialized</a> as &lt;integer&gt;.</li>

       <li><p>If <var>a</var> is one or minus one and
       <var>b</var> is zero let the value be
       "<code>n</code>" (U+006E).</li>

       <li><p>If <var>a</var> is one or minus one let the value be
       "<code>n</code>" (U+006E), followed by
       "<code>+</code>" (U+002B) if <var>b</var> is positive,
       followed by <var>b</var>
       <a href="#serialize-a-css-value-component" title="serialize a CSS component value">serialized</a> as &lt;integer&gt;.</li>

       <li><p>If <var>b</var> is zero let the value be
       <var>a</var>
       <a href="#serialize-a-css-value-component" title="serialize a CSS component value">serialized</a> as &lt;integer&gt;,
       followed by "<code>n</code>" (U+006E).</li>

       <li><p>Otherwise let the value be
       <var>a</var>
       <a href="#serialize-a-css-value-component" title="serialize a CSS component value">serialized</a> as &lt;integer&gt;,
       followed by "<code>n</code>" (U+006E), followed by
       "<code>+</code>" (U+002B) if <var>b</var> is positive,
       followed by <var>b</var>
       <a href="#serialize-a-css-value-component" title="serialize a CSS component value">serialized</a> as &lt;integer&gt;.</li>
      </ol>
     </dd>

     <dt><code>:not()</code></dt>
     <dd><p>The result of serializing the value using the rules for
     <a href="#serialize-a-group-of-selectors" title="serialize a group of selectors">serializing a group of selectors</a>.</dd>
    </dl>
   </dd>
  </dl>

  <!-- ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->

  <h2 id="css"><span class="secno">6 </span>CSS</h2>

  <!-- ........................................................................................................................ -->
  <!-- ........................................................................................................................ -->

  <h3 id="css-style-sheets"><span class="secno">6.1 </span>CSS Style Sheets</h3>

  <!-- XXX
   element inserted into the DOM, style sheet created, element removed from
   the DOM, what happens to StyleSheet?
  -->

  <p>A <dfn id="css-style-sheet">CSS style sheet</dfn> is an abstract concept that
  represents a style sheet as defined by the CSS specification. In the CSSOM a
  <a href="#css-style-sheet">CSS style sheet</a> is represented as a <code>CSSStyleSheet</code> object. A
  <a href="#css-style-sheet">CSS style sheet</a> has a number of associated state items:</p>

  <dl>
   <dt><dfn id="style-sheet-type">style sheet type</dfn></dt>
   <dd><p>The literal string "<code>text/css</code>".</dd>

   <dt><dfn id="style-sheet-location">style sheet location</dfn></dt>
   <dd><p>The <a class="external" href="http://dev.w3.org/html5/spec/single-page.html#url">URL</a> of the
   <span>style sheet</span> or <code>null</code> if the <span>style sheet</span> was
   embedded.</dd>

   <dt><dfn id="style-sheet-parent">style sheet parent</dfn></dt>
   <dd><p>The <span>style sheet</span> that is the parent of the
   <span>style sheet</span> or <code>null</code> if there is no associated parent.</dd>

   <dt><dfn id="style-sheet-owner-node">style sheet owner node</dfn></dt>
   <dd><p>The DOM node associated with the <span>style sheet</span> or
   <code>null</code> if there is no associated DOM node.</dd>

   <dt><dfn id="style-sheet-owner-css-rule">style sheet owner CSS rule</dfn></dt>
   <dd><p>The <a href="#rule">CSS rule</a> in the <a href="#style-sheet-parent">style sheet parent</a>
   that caused the inclusion of the <span>style sheet</span> or <code>null</code> if
   there is no associated rule.</dd>

   <dt><dfn id="style-sheet-media">style sheet media</dfn></dt>
   <dd>
    <p>The <code>MediaList</code> object associated with the
    <span>style sheet</span>.</p>

    <p>If this property is set to a string run the
    <a href="#create-a-medialist-object">create a <code>MediaList</code> object</a> steps for that
    string and associate the returned object with the
    <span>style sheet</span>.</p>
   </dd>

   <dt><dfn id="style-sheet-title">style sheet title</dfn></dt>
   <dd>
    <p>The title of the <span>style sheet</span> or <code>null</code> if no title
    is specified or is the empty string, in which case the title is referred to
    as an empty title.</p>

    <div class="example">
     <p>In the following, the <a href="#style-sheet-title">style sheet title</a> is non-empty
     for the first style sheet, but is empty for the second and third style sheets.</p>
     <pre>&lt;style title="papaya"&gt;
  body { background: papayawhip; }
&lt;/style&gt;</pre>
     <pre>&lt;style title=""&gt;
  body { background: orange; }
&lt;/style&gt;</pre>
     <pre>&lt;style&gt;
  body { background: brown; }
&lt;/style&gt;</pre>
    </div>
   </dd>

   <dt><dfn id="style-sheet-alternate-flag">style sheet alternate flag</dfn></dt>
   <dd>
    <p>Either set or clear. Clear by default.</p>

    <div class="example">
     <p>The following <span title="style sheet">style sheets</span> have
     their <a href="#style-sheet-alternate-flag">style sheet alternate flag</a> set:</p>

     <pre><code>&lt;?xml-stylesheet alternate="yes" title="x" href="data:text/css,…"?&gt;</code></pre>

     <pre><code>&lt;link rel="alternate stylesheet" title="x" href="data:text/css,…"&gt;</code></pre>
    </div>
   </dd>

   <dt><dfn id="style-sheet-disabled-flag">style sheet disabled flag</dfn></dt>
   <dd>
    <p>Either set or clear. Clear by default.</p>

    <p class="note">Even when clear it does not necessarily mean that the
    <span>style sheet</span> is actually used for rendering.</p>
   </dd>


   <dt><dfn id="style-sheet-css-rules">style sheet CSS rules</dfn></dt>
   <dd><p>The <a href="#rule" title="CSS rule">CSS rules</a> associated with the
   <span>style sheet</span>.</dd>
  </dl>

  <p>When you are to <a href="#create-a-style-sheet">create a style sheet</a> the above properties,
  with the exception of <a href="#style-sheet-type">style sheet type</a> and
  <a href="#style-sheet-css-rules">style sheet CSS rules</a>, are to be set to
  their proper values.</p>

  <!-- same-origin restrictions -->

  <!-- ........................................................................................................................ -->

  <h4 id="the-stylesheet-interface"><span class="secno">6.1.1 </span>The <code>StyleSheet</code> Interface</h4>

  <p>The <code>StyleSheet</code> interface represents an abstract, base style sheet.</p>
<pre class="idl"><span class="idlInterface" id="widl-def-StyleSheet">interface <span class="idlInterfaceID">StyleSheet</span> {
<span class="idlAttribute">    readonly attribute <span class="idlAttrType"><a>DOMString</a></span> <span class="idlAttrName"><a href="#widl-StyleSheet-type">type</a></span>;</span>
<span class="idlAttribute">    readonly attribute <span class="idlAttrType"><a>DOMString</a>?</span> <span class="idlAttrName"><a href="#widl-StyleSheet-href">href</a></span>;</span>
<span class="idlAttribute">    readonly attribute <span class="idlAttrType"><a>Node</a></span> <span class="idlAttrName"><a href="#widl-StyleSheet-ownerNode">ownerNode</a></span>;</span>
<span class="idlAttribute">    readonly attribute <span class="idlAttrType"><a>StyleSheet</a>?</span> <span class="idlAttrName"><a href="#widl-StyleSheet-parentStyleSheet">parentStyleSheet</a></span>;</span>
<span class="idlAttribute">    readonly attribute <span class="idlAttrType"><a>DOMString</a>?</span> <span class="idlAttrName"><a href="#widl-StyleSheet-title">title</a></span>;</span>
<span class="idlAttribute">    readonly attribute <span class="idlAttrType"><a>MediaList</a></span> <span class="idlAttrName"><a href="#widl-StyleSheet-media">media</a></span>;</span>
<span class="idlAttribute">    attribute <span class="idlAttrType"><a>boolean</a></span> <span class="idlAttrName"><a href="#widl-StyleSheet-disabled">disabled</a></span>;</span>
};</span></pre>
<dl class="attributes">
<dt class="attribute" id="widl-StyleSheet-type">
<code>type</code> of type <span class="idlAttrType"><a>DOMString</a></span>, readonly</dt>
<dd>
<p>The <code>type</code> attribute must return the <a href="#style-sheet-type">style sheet type</a>.</dd>
<dt class="attribute" id="widl-StyleSheet-href">
<code>href</code> of type <span class="idlAttrType"><a>DOMString</a>?</span>, readonly</dt>
<dd>
<p>The <code>href</code> attribute must return the <a href="#style-sheet-location">style sheet location</a> or <code>null</code> if none.</p>    <p class="issue">What should the default value be if not known or specified upon creation? an empty string or <code>null</code>?</dd>
<dt class="attribute" id="widl-StyleSheet-ownerNode">
<code>ownerNode</code> of type <span class="idlAttrType"><a>Node</a></span>, readonly</dt>
<dd>
<p>The <code>ownerNode</code> attribute must return the <a href="#style-sheet-owner-node">style sheet owner node</a>.</p>    <p class="issue">Should <code>ownerNode</code> be nullable?</dd>
<dt class="attribute" id="widl-StyleSheet-parentStyleSheet">
<code>parentStyleSheet</code> of type <span class="idlAttrType"><a>StyleSheet</a>?</span>, readonly</dt>
<dd>
<p>The <code>parentStyleSheet</code> attribute must return the <a href="#style-sheet-parent">style sheet parent</a> or <code>null</code> if there is none.</dd>
<dt class="attribute" id="widl-StyleSheet-title">
<code>title</code> of type <span class="idlAttrType"><a>DOMString</a>?</span>, readonly</dt>
<dd>
<p>The <code>title</code> attribute must return the <a href="#style-sheet-title">style sheet title</a> or <code>null</code> if none.</p>    <p class="issue">What should the default value be if not known or specified upon creation? an empty string or <code>null</code>?</dd>
<dt class="attribute" id="widl-StyleSheet-media">
<code>media</code> of type <span class="idlAttrType"><a>MediaList</a></span>, readonly</dt>
<dd>
<p>The <code>media</code> attribute must return the <a href="#style-sheet-media">style sheet media</a>.</p>    <p class="issue">Should <code>media</code> be nullable?</p>    <p class="issue">Need to define a setter that implements the semantics of setting this attribute to a string representing a MediaList.</dd>
<dt class="attribute" id="widl-StyleSheet-disabled">
<code>disabled</code> of type <span class="idlAttrType"><a>boolean</a></span></dt>
<dd>
<p>The <code>disabled</code> attribute must return true if the <a href="#style-sheet-disabled-flag">style sheet disabled flag</a>    is set, or false otherwise.</p>    <p>Setting the <code>disabled</code> attribute must set the <a href="#style-sheet-disabled-flag">style sheet disabled flag</a>    if the new value is true, or unset the <a href="#style-sheet-disabled-flag">style sheet disabled flag</a> otherwise.</dd>
</dl>


  <!-- ........................................................................................................................ -->

  <h4 id="the-cssstylesheet-interface"><span class="secno">6.1.2 </span>The <code>CSSStyleSheet</code> Interface</h4>

  <p>The <code>CSSStyleSheet</code> interface represents a CSS <span>style sheet</span> rule.</p>
<pre class="idl"><span class="idlInterface" id="widl-def-CSSStyleSheet">interface <span class="idlInterfaceID">CSSStyleSheet</span> : <span class="idlSuperclass"><a class="idlType" href="#widl-def-StyleSheet"><code>StyleSheet</code></a></span> {
<span class="idlAttribute">    readonly attribute <span class="idlAttrType"><a>CSSRule</a>?</span> <span class="idlAttrName"><a href="#widl-CSSStyleSheet-ownerRule">ownerRule</a></span>;</span>
<span class="idlAttribute">    readonly attribute <span class="idlAttrType"><a>CSSRuleList</a></span> <span class="idlAttrName"><a href="#widl-CSSStyleSheet-cssRules">cssRules</a></span>;</span>
<span class="idlMethod">    <span class="idlMethType"><a>unsigned long</a></span> <span class="idlMethName"><a href="#widl-CSSStyleSheet-insertRule-unsigned-long-DOMString-rule-unsigned-long-index">insertRule</a></span> (<span class="idlParam"><span class="idlParamType"><a>DOMString</a></span> <span class="idlParamName">rule</span></span>, <span class="idlParam"><span class="idlParamType"><a>unsigned long</a></span> <span class="idlParamName">index</span></span>);</span>
<span class="idlMethod">    <span class="idlMethType"><a>void</a></span> <span class="idlMethName"><a href="#widl-CSSStyleSheet-deleteRule-void-unsigned-long-index">deleteRule</a></span> (<span class="idlParam"><span class="idlParamType"><a>unsigned long</a></span> <span class="idlParamName">index</span></span>);</span>
};</span></pre>
<dl class="attributes">
<dt class="attribute" id="widl-CSSStyleSheet-ownerRule">
<code>ownerRule</code> of type <span class="idlAttrType"><a>CSSRule</a>?</span>, readonly</dt>
<dd>
<p>The <code>ownerRule</code> attribute must return the <a href="#style-sheet-owner-css-rule">style sheet owner CSS rule</a> or <code>null</code> if none.    If a value other than <code>null</code> is ever returned, than that same value must always be returned on each get access.</dd>
<dt class="attribute" id="widl-CSSStyleSheet-cssRules">
<code>cssRules</code> of type <span class="idlAttrType"><a>CSSRuleList</a></span>, readonly</dt>
<dd>
<p>The <code>cssRules</code> attribute must return a read-only, live <code>CSSRuleList</code> object representing the <a href="#style-sheet-css-rules">style    sheet CSS rules</a>. The same object must be returned on each get access.</p>    <p class="note">Even though the returned <code>CSSRuleList</code> object is read-only (from the perspective of    client-authored script), it may nevertheless change over time due to its liveness status. For example, invoking    the <code>insertRule</code> or <code>deleteRule</code> operation may result in mutations reflected in the returned object.</dd>
</dl>
<dl class="methods">
<dt class="method" id="widl-CSSStyleSheet-insertRule-unsigned-long-DOMString-rule-unsigned-long-index">
<code>insertRule</code> (<span class="idlParam"><span class="idlParamType"><a>DOMString</a></span> <span class="idlParamName">rule</span></span>, <span class="idlParam"><span class="idlParamType"><a>unsigned long</a></span> <span class="idlParamName">index</span></span>), returns <span class="idlMethType"><a>unsigned long</a></span></dt>
<dd>
<p>The <code>insertRule</code> operation performs <dfn id="insert-a-css-rule">insert a CSS rule</dfn> <var>rule</var> as follows:</p>    <ol>    <li><p>Set <var>newRule</var> to the results of performing <a href="#parse-a-css-rule">parse a CSS rule</a>    on argument <var>rule</var>, <a class="external" href="http://dom.spec.whatwg.org/#concept-throw" title="concept-throw">throwing</a>    a "<code class="external"><a href="http://dom.spec.whatwg.org/#syntaxerror">SyntaxError</a></code>" exception if a parse error occurs.</li>    <li><p>Set <var>N</var> to <code>cssLength.length</code>.</li>    <li><p>If argument <var>index</var> is greater than <var>N</var>, then <a class="external" href="http://dom.spec.whatwg.org/#concept-throw" title="concept-throw">throw</a>    an "<code class="external"><a href="http://dom.spec.whatwg.org/#indexsizeerror">IndexSizeError</a></code>" exception.</li>    <li><p>If the rule <var>newRule</var> cannot be inserted into the specified <var>index</var> due to constraints specified    by <a href="#refsCSS">[CSS]</a>, then <a class="external" href="http://dom.spec.whatwg.org/#concept-throw" title="concept-throw">throw</a>    a "<code class="external"><a href="http://dom.spec.whatwg.org/#hierarchyrequesterror">HierarchyRequestError</a></code>" exception.</p>    <p class="note">For example, a CSS style sheet cannot contain more than one <code>@charset</code> rule, which,    if present, must be the first rule.</li>    <li><p>Set <var>newRule</var><code>.parentStyleSheet</code> to <code>this</code> (i.e., this <code>CSSStyleSheet</code> instance object).</li>    <li><p>Insert rule <var>newRule</var> into <code>cssRules</code> at the zero-indexed position <var>index</var>.<p></li>    <li><p>Return <var>index</var>.</li>    </ol>    <p class="note">If a new rule is inserted, then any rule previously located at position <var>index</var> through    <var>N</var> minus 1 is shifted to position <var>index</var> plus 1 through <var>N</var>,    In addition, <code>cssRules.length</code> is (internally) incremented.</p>    <p class="issue">DOM-2 CSS specifies that a <code>NO_MODIFICATION_ALLOWED_ERR</code> exception is thrown    if the style sheet is read-only. Are there any read-only style sheets?</dd>
<dt class="method" id="widl-CSSStyleSheet-deleteRule-void-unsigned-long-index">
<code>deleteRule</code> (<span class="idlParam"><span class="idlParamType"><a>unsigned long</a></span> <span class="idlParamName">index</span></span>), returns <span class="idlMethType"><a>void</a></span></dt>
<dd>
<p>The <code>deleteRule</code> operation performs <dfn id="remove-a-css-rule">remove a CSS rule</dfn> as follows:</p>    <ol>    <li><p>Set <var>N</var> to <code>cssLength.length</code>.</li>    <li><p>If argument <var>index</var> is greater than or equal to <var>N</var>, then <a class="external" href="http://dom.spec.whatwg.org/#concept-throw" title="concept-throw">throw</a>    an "<code class="external"><a href="http://dom.spec.whatwg.org/#indexsizeerror">IndexSizeError</a></code>" exception.</li>    <li><p>Set <var>oldRule</var> to <code>cssRules.prototype.item(<var>index</var>)</code>.</li>    <li><p>Set <var>oldRule</var><code>.parentStyleSheet</code> to <code>null</code>.</li>    <li><p>Remove rule <var>oldRule</var> from <code>cssRules</code> at the zero-indexed position <var>index</var>.<p></li>    </ol>    <p class="note">If an existing rule is deleted, then any rule previously located at position <var>index</var> plus 1 through    <var>N</var> minus 1 is shifted to position <var>index</var> through <var>N</var> minus 2,    In addition, <code>cssRules.length</code> is (internally) decremented.</dd>
</dl>


  <!-- ........................................................................................................................ -->
  <!-- ........................................................................................................................ -->

  <h3 id="style-sheet-collections"><span class="secno">6.2 </span>Style Sheet Collections</h3>

  <p>Below various new concepts are defined that are associated with each
  <code class="external"><a href="http://dom.spec.whatwg.org/#document">Document</a></code> object.</p>

  <p>Each <code class="external"><a href="http://dom.spec.whatwg.org/#document">Document</a></code> has an associated list of zero or more
  <span title="style sheet">style sheets</span>, named the
  <dfn id="document-style-sheets">document style sheets</dfn>. This is
  an ordered list that contains all
  <span title="style sheet">style sheets</span> associated with the
  <code class="external"><a href="http://dom.spec.whatwg.org/#document">Document</a></code>, in
  <a class="external" href="http://dom.spec.whatwg.org/#concept-tree-order" title="concept-tree-order">tree order</a>, with
  <span title="style sheet">style sheets</span> created from HTTP
  <code title="http-link">Link</code> headers first, if any, in header
  order.</p>

  <p>To <dfn id="create-a-style-sheet">create a style sheet</dfn>, run these
  steps:</p>

  <ol>
   <li><p>Create a new <span>style sheet</span> object and set its
   properties as specified.</li>

   <li><p>Then run the <a href="#add-a-style-sheet">add a style sheet</a> steps for the newly
   created <span>style sheet</span>.</li>
  </ol>

  <p>To <dfn id="add-a-style-sheet">add a style sheet</dfn>, run these
  steps:</p>

  <ol>
   <li><p>Add the <span>style sheet</span> to the list of
   <a href="#document-style-sheets">document style sheets</a> at the appropriate location. The
   remainder of these steps deal with the
   <a href="#style-sheet-disabled-flag">style sheet disabled flag</a>.</li>

   <li><p>If the <a href="#style-sheet-disabled-flag">style sheet disabled flag</a> is set, terminate
   these steps.</li>

   <li><p>If the <a href="#style-sheet-title">style sheet title</a> is non-empty, the
   <a href="#style-sheet-alternate-flag">style sheet alternate flag</a> is clear, and
   <a href="#preferred-style-sheet-set-name">preferred style sheet set name</a> is the empty string
   <a href="#change-the-preferred-style-sheet-set-name">change the preferred style sheet set name</a> to the
   <a href="#style-sheet-title">style sheet title</a>.</li>

   <li>
    <p>If any of the following is true clear the
    <a href="#style-sheet-disabled-flag">style sheet disabled flag</a> and terminate these steps:

    <ul>
     <li><p>The <a href="#style-sheet-title">style sheet title</a> is empty.</li>
     <li><p>The <a href="#last-style-sheet-set-name">last style sheet set name</a> is <code>null</code> and the
     <a href="#style-sheet-title">style sheet title</a> is a
     <a class="external" href="http://dom.spec.whatwg.org/#case-sensitive">case-sensitive</a> match
     for the <a href="#preferred-style-sheet-set-name">preferred style sheet set name</a>.</li>
     <li><p>The <a href="#style-sheet-title">style sheet title</a> is a
     <a class="external" href="http://dom.spec.whatwg.org/#case-sensitive">case-sensitive</a> match for the
     <a href="#last-style-sheet-set-name">last style sheet set name</a>.</li>
    </ul>
   </li>

   <li><p>Set the <a href="#style-sheet-disabled-flag">style sheet disabled flag</a>.</li>
  </ol>

  <p>A <dfn id="persistent-style-sheet">persistent style sheet</dfn> is a
  <span>style sheet</span> from the <a href="#document-style-sheets">document style sheets</a>
  whose <a href="#style-sheet-title">style sheet title</a> is the empty string and whose
  <a href="#style-sheet-alternate-flag">style sheet alternate flag</a> is clear.</p>

  <p>A <dfn id="style-sheet-set">style sheet set</dfn> is an ordered
  collection of one or more <span title="style sheet">style sheets</span>
  from the <a href="#document-style-sheets">document style sheets</a> which have an identical
  <a href="#style-sheet-title">style sheet title</a> that is not the empty string.</p>

  <p>A <dfn id="style-sheet-set-name">style sheet set name</dfn> is the
  <a href="#style-sheet-title">style sheet title</a> the <a href="#style-sheet-set">style sheet set</a> has in
  common.</p>

  <p>An <dfn id="enabled-style-sheet-set">enabled style sheet set</dfn> is a
  <a href="#style-sheet-set">style sheet set</a> of which each <span>style sheet</span> has
  its <a href="#style-sheet-disabled-flag">style sheet disabled flag</a> clear.</p>

  <p>To <dfn id="enable-a-style-sheet-set">enable a style sheet set</dfn>
  with name <var>name</var>, run these steps:</p>

  <ol>
   <li><p>If <var>name</var> is the empty string, set the
   <a href="#style-sheet-disabled-flag">style sheet disabled flag</a> for each <span>style sheet</span>
   that is in a <a href="#style-sheet-set">style sheet set</a> and terminate these steps.</li>

   <li><p>Clear the <a href="#style-sheet-disabled-flag">style sheet disabled flag</a> for each
   <span>style sheet</span> in a <a href="#style-sheet-set">style sheet set</a> whose
   <a href="#style-sheet-set-name">style sheet set name</a> is a
   <a class="external" href="http://dom.spec.whatwg.org/#case-sensitive">case-sensitive</a> match for
   <var>name</var> and set it for all other
   <span title="style sheet">style sheets</span> in a
   <a href="#style-sheet-set">style sheet set</a>.</li>
  </ol>

  <p>To <dfn id="select-a-style-sheet-set">select a style sheet set</dfn>
  with name <var>name</var>, run these steps:</p>

  <ol>
   <li><p><a href="#enable-a-style-sheet-set">Enable a style sheet set</a> with name
   <var>name</var>.</li>

   <li><p>Set <a href="#last-style-sheet-set-name">last style sheet set name</a> to
   <var>name</var>.</li>
  </ol>

  <p>A <dfn id="last-style-sheet-set-name">last style sheet set name</dfn>
  is a concept to determine what <a href="#style-sheet-set">style sheet set</a> was last
  <a href="#select-a-style-sheet-set" title="select a style sheet set">selected</a>. Initially its
  value is <code>null</code>.</p>

  <p>A
  <dfn id="preferred-style-sheet-set-name">preferred style sheet set name</dfn>
  is a concept to determine which
  <span title="style sheet">style sheets</span> need to have their
  <a href="#style-sheet-disabled-flag">style sheet disabled flag</a> clear. Initially its value
  is the empty string.

  <p>To
  <dfn id="change-the-preferred-style-sheet-set-name">change the preferred style sheet set name</dfn>
  with name <var>name</var>, run these steps:</p>

  <ol>
   <li><p>Let <var>current</var> be the <a href="#preferred-style-sheet-set-name">preferred style sheet set name</a>.</li>

   <li><p>Set <a href="#preferred-style-sheet-set-name">preferred style sheet set name</a> to
   <var>name</var>.</li>

   <li><p>If <var>name</var> is not a
   <a class="external" href="http://dom.spec.whatwg.org/#case-sensitive">case-sensitive</a> match for
   <var>current</var> and
   <a href="#last-style-sheet-set-name">last style sheet set name</a> is <code>null</code>
   <a href="#enable-a-style-sheet-set">enable a style sheet set</a> with name
   <var>name</var>.</li>
  </ol>

  <!-- XXX ought to define "applied"

  thoughts:
    depends on disabled flag, alternate flag, media queries, sheesh
   -->

  <!-- ........................................................................................................................ -->

  <h4 id="the-http-default-style-header"><span class="secno">6.2.1 </span>The HTTP <code>Default-Style</code> Header</h4>

  <p>The HTTP <code title="http-default-style"><a href="#default-style">Default-Style</a></code> header
  can be used to set the <a href="#preferred-style-sheet-set-name">preferred style sheet set name</a>
  influencing which <a href="#style-sheet-set">style sheet set</a> is (initially) the
  <a href="#enabled-style-sheet-set">enabled style sheet set</a>.</p>

  <p>For each HTTP <code title="http-default-style"><a href="#default-style">Default-Style</a></code>
  header, in header order, the user agent must
  <a href="#change-the-preferred-style-sheet-set-name">change the preferred style sheet set name</a> with name being the
  value of the header.</p>

  <!-- ........................................................................................................................ -->

  <h4 id="the-stylesheetlist-sequence"><span class="secno">6.2.2 </span>The <code>StyleSheetList</code> Sequence</h4>

  <p>The <code>StyleSheetList</code> sequence represents an ordered collection of <span title="style sheets">style sheets</span>.</p>
<pre class="idl">[[TBD - TYPEDEF]]
</pre>


  <!-- ........................................................................................................................ -->

  <h4 id="extensions-to-the-document-interface"><span class="secno">6.2.3 </span>Extensions to the <code>Document</code> Interface</h4>

  
<pre class="idl"><span class="idlInterface" id="widl-def-Document">partial interface <span class="idlInterfaceID">Document</span> {
<span class="idlAttribute">    readonly attribute <span class="idlAttrType"><a>StyleSheetList</a></span> <span class="idlAttrName"><a href="#widl-Document-styleSheets">styleSheets</a></span>;</span>
<span class="idlAttribute">    attribute <span class="idlAttrType"><a>DOMString</a>?</span> <span class="idlAttrName"><a href="#widl-Document-selectedStyleSheetSet">selectedStyleSheetSet</a></span>;</span>
<span class="idlAttribute">    readonly attribute <span class="idlAttrType"><a>DOMString</a>?</span> <span class="idlAttrName"><a href="#widl-Document-lastStyleSheetSet">lastStyleSheetSet</a></span>;</span>
<span class="idlAttribute">    readonly attribute <span class="idlAttrType"><a>DOMString</a>?</span> <span class="idlAttrName"><a href="#widl-Document-preferredStyleSheetSet">preferredStyleSheetSet</a></span>;</span>
<span class="idlAttribute">    readonly attribute <span class="idlAttrType"><a>DOMStringList</a></span> <span class="idlAttrName"><a href="#widl-Document-styleSheetSets">styleSheetSets</a></span>;</span>
<span class="idlMethod">    <span class="idlMethType"><a>void</a></span> <span class="idlMethName"><a href="#widl-Document-enableStyleSheetsForSet-void-DOMString-name">enableStyleSheetsForSet</a></span> (<span class="idlParam"><span class="idlParamType"><a>DOMString</a>?</span> <span class="idlParamName">name</span></span>);</span>
};</span></pre>
<dl class="attributes">
<dt class="attribute" id="widl-Document-styleSheets">
<code>styleSheets</code> of type <span class="idlAttrType"><a>StyleSheetList</a></span>, readonly</dt>
<dd>
<p>The <code>styleSheets</code> attribute must return a <code>StyleSheetList</code> sequence representing    the <a href="#document-style-sheets">document style sheets</a>.</p>    <p class="note">Because of historical IDL limitations the <code>styleSheets</code> attribute    used to be on a separate interface, <code>DocumentStyle</code>.</dd>
<dt class="attribute" id="widl-Document-selectedStyleSheetSet">
<code>selectedStyleSheetSet</code> of type <span class="idlAttrType"><a>DOMString</a>?</span></dt>
<dd>
<p>The <code>selectedStyleSheetSet</code> attribute must, on getting, must run these steps:</p>    <ol>      <li><p>If there is a single <a href="#enabled-style-sheet-set">enabled style sheet set</a> and no      other <a href="#document-style-sheets">document style sheets</a> with a non-empty      <a href="#style-sheet-title">style sheet title</a> have the      <a href="#style-sheet-disabled-flag">style sheet disabled flag</a> unset, return the      <a href="#style-sheet-set-name">style sheet set name</a> of the      <a href="#enabled-style-sheet-set">enabled style sheet set</a> and terminate these steps.</li>            <li><p>Otherwise, if <span title="style sheet">style sheets</span> from      different <a href="#style-sheet-set" title="style sheet set">style sheet sets</a> have      their <a href="#style-sheet-disabled-flag">style sheet disabled flag</a> unset, return      <code>null</code> and terminate these steps.</li>            <li>       <p>Otherwise, return the empty string.</p>             <p class="note">At this point either all       <span title="style sheet">style sheets</span> with a non-empty       <a href="#style-sheet-title">style sheet title</a> have the       <a href="#style-sheet-disabled-flag">style sheet disabled flag</a> set, or there are no such       <span title="style sheet">style sheets</span>.</p>      </li>     </ol>        <p>On setting the    <code title="dom-Document-selectedStyleSheetSet">selectedStyleSheetSet</code>    attribute these steps must be run:</p>        <ol>      <li><p>If the value is <code>null</code> terminate this set of steps.</li>      <li><p>Otherwise, <a href="#select-a-style-sheet-set">select a style sheet set</a> with as name the      value passed.</li>    </ol>        <p>From the DOM's perspective, all views have the same    <code title="dom-Document-selectedStyleSheetSet">selectedStyleSheetSet</code>.    If a user agent supports multiple views with different selected    alternative style sheets, then this attribute (and the    <code>StyleSheet</code> interface's    <code title="dom-StyleSheet-disabled">disabled</code> attribute)    must return and set the value for the default    view.</dd>
<dt class="attribute" id="widl-Document-lastStyleSheetSet">
<code>lastStyleSheetSet</code> of type <span class="idlAttrType"><a>DOMString</a>?</span>, readonly</dt>
<dd>
<p>The <code>lastStyleSheetSet</code> attribute must  return the <a href="#last-style-sheet-set-name">last style sheet set name</a>.</p>    <p class="note">This attribute is initially <code>null</code>.</dd>
<dt class="attribute" id="widl-Document-preferredStyleSheetSet">
<code>preferredStyleSheetSet</code> of type <span class="idlAttrType"><a>DOMString</a>?</span>, readonly</dt>
<dd>
<p>The <code>preferredStyleSheetSet</code> attribute must  return the <a href="#preferred-style-sheet-set-name">preferred style sheet set name</a>.</p>    <p class="note">Unlike <code title="dom-Document-lastStyleSheetSet">lastStyleSheetSet</code>,    this attribute is initially the empty string.</dd>
<dt class="attribute" id="widl-Document-styleSheetSets">
<code>styleSheetSets</code> of type <span class="idlAttrType"><a>DOMStringList</a></span>, readonly</dt>
<dd>
<p>The <code>styleSheetSets</code> attribute must  return a list of the <a href="#style-sheet-set-name" title="style sheet set name">style    sheet set names</a> of the <a href="#style-sheet-set" title="style sheet set">style sheet sets</a>, in order    of the <a href="#document-style-sheets">document style sheets</a>.</dd>
</dl>
<dl class="methods">
<dt class="method" id="widl-Document-enableStyleSheetsForSet-void-DOMString-name">
<code>enableStyleSheetsForSet</code> (<span class="idlParam"><span class="idlParamType"><a>DOMString</a>?</span> <span class="idlParamName">name</span></span>), returns <span class="idlMethType"><a>void</a></span></dt>
<dd>
<p>The <code>enableStyleSheetsForSet</code> operation must, when invoked, run these steps:</p>    <ol>      <li><p>If <var>name</var> is <code>null</code> terminate these steps.</li>      <li><p><a href="#enable-a-style-sheet-set">Enable a style sheet set</a> with name <var>name</var>.</li>    </ol>    <p class="note"><span title="Style sheet">Style sheets</span> with an    empty <a href="#style-sheet-title">style sheet title</a> are never affected by this method.    This method does not change the values of the    <code title="dom-Document-lastStyleSheetSet">lastStyleSheetSet</code> or    <code title="dom-Document-preferredStyleSheetSet">preferredStyleSheetSet</code> attributes.</dd>
</dl>


  <!-- ........................................................................................................................ -->

  <h4 id="interaction-with-the-user-interface"><span class="secno">6.2.4 </span>Interaction with the User Interface</h4>

  <p>The user interface of Web browsers that support style sheets
  should list the style sheet titles given in the
  <code title="dom-Document-styleSheetSets">styleSheetSets</code> list,
  showing the
  <code title="dom-Document-selectedStyleSheetSet">selectedStyleSheetSet</code>
  as the selected style sheet set, leaving none selected if it is
  <code>null</code> or the empty string, and selecting an extra option
  "Basic Page Style" (or similar) if it is the empty string and the
  <code title="dom-Document-preferredStyleSheetSet">preferredStyleSheetSet</code>
  is the empty string as well.</p>

  <p>Selecting a style sheet from this list should
  use the <a href="#select-a-style-sheet-set">select a style sheet set</a> set of steps. This
  (by definition) affects the
  <code title="dom-Document-lastStyleSheetSet">lastStyleSheetSet</code>
  attribute.</p>

  <h5 id="persisting-the-selected-style-sheet-set"><span class="secno">6.2.4.1 </span>Persisting the selected style sheet set</h5>

  <p>If a user agent persist the selected style sheet set, they should use
  the value of the
  <code title="dom-Document-selectedStyleSheetSet">selectedStyleSheetSet</code>
  attribute, or if that is <code>null</code>, the
  <code title="dom-Document-lastStyleSheetSet">lastStyleSheetSet</code>
  attribute, when leaving the page (or at some other time) to determine the
  set name to store. If that is <code>null</code> then the style sheet set should not be
  persisted.</p>

  <p>When re-setting the style sheet set to the persisted value (which can
  happen at any time, typically at the first time the style sheets are
  needed for styling the document, after the <code>&lt;head&gt;</code> of
  the document has been parsed, after any scripts that are not dependent on
  computed style have executed), the style sheet set
  should be set by using the
  <a href="#select-a-style-sheet-set">select a style sheet set</a> set of steps as if the user had
  selected the set manually.</p>

  <p class="note">This specification does not give any suggestions on
  how user agents should decide to persist the style sheet set or whether or
  how to persist the selected set across pages.</p>

  <!-- XXX this UI section suggests we may want to introduce a few more
       idioms -->

  <!-- ........................................................................................................................ -->

  <h4 id="examples"><span class="secno">6.2.5 </span>Examples</h4>

  <div class="example">
   <p>Thus, in the following HTML snippet:</p>

   <pre>&lt;link rel="alternate stylesheet" title="foo" href="a"&gt;
&lt;link rel="alternate stylesheet" title="bar" href="b"&gt;
&lt;script&gt;
  document.selectedStyleSheetSet = 'foo';
  document.styleSheets[1].disabled = false;
&lt;/script&gt;
&lt;link rel="alternate stylesheet" title="foo" href="c"&gt;
&lt;link rel="alternate stylesheet" title="bar" href="d"&gt;</pre>

   <p>...the style sheets that end up enabled are style sheets "a", "b",
   and "c", the
   <code title="dom-Document-selectedStyleSheetSet">selectedStyleSheetSet</code>
   attribute would return <code>null</code>,
   <code title="dom-Document-lastStyleSheetSet">lastStyleSheetSet</code>
   would return "foo", and
   <code title="dom-Document-preferredStyleSheetSet">preferredStyleSheetSet</code>
   would return the empty string.</p>

   <p>Similarly, in the following HTML snippet:</p>

   <pre>&lt;link rel="alternate stylesheet" title="foo" href="a"&gt;
&lt;link rel="alternate stylesheet" title="bar" href="b"&gt;
&lt;script&gt;
  var before = document.preferredStyleSheetSet;
  document.styleSheets[1].disabled = false;
&lt;/script&gt;
&lt;link rel="stylesheet" title="foo" href="c"&gt;
&lt;link rel="alternate stylesheet" title="bar" href="d"&gt;
&lt;script&gt;
  var after = document.preferredStyleSheetSet;
&lt;/script&gt;</pre>

   <p>...the "before" variable will be equal to the empty string, the
   "after" variable will be equal to "foo", and style sheets "a" and "c"
   will be enabled. This is the case even though the first script block
   sets style sheet "b" to be enabled, because upon parsing the
   following <code>&lt;link&gt;</code> element, the
   <code title="dom-Document-preferredStyleSheetSet">preferredStyleSheetSet</code>
   is set and the
   <code title="dom-Document-enableStyleSheetsForSet">enableStyleSheetsForSet()</code>
   method is called (since
   <code title="dom-Document-selectedStyleSheetSet">selectedStyleSheetSet</code>
   was never set
   explicitly, leaving
   <code title="dom-Document-lastStyleSheetSet">lastStyleSheetSet</code> at
   <code>null</code> throughout), which changes which style sheets are enabled and which
   are not.</p>
  </div>

  <!-- ........................................................................................................................ -->
  <!-- ........................................................................................................................ -->

  <h3 id="style-sheet-association"><span class="secno">6.3 </span>Style Sheet Association</h3>

  <p>This section defines the interface a
  <a href="#style-sheet-owner-node">style sheet owner node</a> of a <span>style sheet</span> has to
  implement and defines the requirements for
  <a class="external" href="http://www.w3.org/TR/xml-stylesheet/#dt-xml-stylesheet" title="xml-stylesheet processing instruction">xml-stylesheet processing instructions</a>
  and HTTP <code title="http-link">Link</code> headers when the link
  relation type is an
  <a class="external" href="http://dom.spec.whatwg.org/#ascii-case-insensitive">ASCII case-insensitive</a> match for
  "<code>stylesheet</code>" since nobody else was interested in
  defining this.</p>

  <p class="note">The editor is in good hope that HTML and SVG will define the
  appropriate processing in their respective specifications, in terms of
  this specification, in due course.</p>


  <!-- ........................................................................................................................ -->

  <h4 id="the-linkstyle-interface"><span class="secno">6.3.1 </span>The <code>LinkStyle</code> Interface</h4>

  <p>The <dfn id="associated-style-sheet">associated style sheet</dfn> of a node is the <span>style sheet</span> in the list of  <a href="#document-style-sheets">document style sheets</a> of which the <a href="#style-sheet-owner-node">style sheet owner node</a> implements the <code>LinkStyle</code> interface.</p>
<pre class="idl"><span class="idlInterface" id="widl-def-LinkStyle">[NoInterfaceObject]
interface <span class="idlInterfaceID">LinkStyle</span> {
<span class="idlAttribute">    readonly attribute <span class="idlAttrType"><a>StyleSheet</a></span> <span class="idlAttrName"><a href="#widl-LinkStyle-sheet">sheet</a></span>;</span>
};</span></pre>
<dl class="attributes">
<dt class="attribute" id="widl-LinkStyle-sheet">
<code>sheet</code> of type <span class="idlAttrType"><a>StyleSheet</a></span>, readonly</dt>
<dd>
<p>The <code>sheet</code> attribute must return the <a href="#associated-style-sheet">associated style sheet</a> for the node, or <code>null</code>,    if there is no <a href="#associated-style-sheet">associated style sheet</a>.</dd>
</dl>


  <div class="example">
   <p>In the following HTML snippet the first HTML <code>style</code>
   element has a <code>sheet</code> attribute that returns a
   <code>StyleSheet</code> object representing the style sheet, but for
   the second <code>style</code> attribute it returns <code>null</code>.
   (Assuming the user agent supports CSS (<code>text/css</code>) and does
   not support ExampleSheets (<code>text/example-sheets</code>).</p>

   <pre>&lt;style type=text/css&gt; body { background:lime } &lt;/style&gt;
&lt;style type=text/example-sheets&gt; $(body).background := lime &lt;/style&gt;</pre>
  </div>

  <p class="note">Whether or not the node refers to a style sheet is defined
  by the specification that defines the semantics of said node.</p>

  <!-- ........................................................................................................................ -->

  <h4 id="requirements-on-specifications"><span class="secno">6.3.2 </span>Requirements on specifications</h4>

  <p>Specifications introducing new ways of associating style sheets through
  the DOM should define which nodes implement the
  <code>LinkStyle</code> interface. When doing so, they
  must also define when a <span>style sheet</span> is
  <a href="#create-a-style-sheet" title="create a style sheet">created</a>.</p>




  <!-- ........................................................................................................................ -->

  <h4 id="requirements-on-user-agents-implementing-the-xml-stylesheet-processing-instruction"><span class="secno">6.3.3 </span>Requirements on User Agents Implementing the
  <span><code>xml-stylesheet</code> processing instruction</span></h4>

  <!-- XXX load/error events, reparse -->

  
<pre class="idl">[[TBD - IMPLEMENTS]]
</pre>


  <!--
  <pre class="idl"><span data-anolis-spec=dom>ProcessingInstruction</span> implements <span>LinkStyle</span>;</pre>
  -->

  <p>For each
  <a class="external" href="http://www.w3.org/TR/xml-stylesheet/#dt-xml-stylesheet"><code>xml-stylesheet</code> processing instruction</a>
  that is not part of the
  <a class="external" href="http://www.w3.org/TR/xml/#dt-doctype">document type declaration</a> and has an
  <code>href</code>
  <a class="external" href="http://www.w3.org/TR/xml-stylesheet/#dt-pseudo-attribute">pseudo-attribute</a> these steps must
  (unless otherwise stated) be run:</p>

  <ol>
   <li><p>Let <var>title</var> be the value of the
   <code>title</code> <a class="external" href="http://www.w3.org/TR/xml-stylesheet/#dt-pseudo-attribute">pseudo-attribute</a> or the empty string if the
   <code>title</code> <a class="external" href="http://www.w3.org/TR/xml-stylesheet/#dt-pseudo-attribute">pseudo-attribute</a> is not specified.</li>

   <li><p>If there is an <code>alternate</code> <a class="external" href="http://www.w3.org/TR/xml-stylesheet/#dt-pseudo-attribute">pseudo-attribute</a>
   whose value is a <a class="external" href="http://dom.spec.whatwg.org/#case-sensitive">case-sensitive</a> match
   for "<code>yes</code>" and <var>title</var> is the
   empty string terminate these steps.</li>

   <li><p>If there is a <code>type</code> <a class="external" href="http://www.w3.org/TR/xml-stylesheet/#dt-pseudo-attribute">pseudo-attribute</a> whose
   value is not a <span>supported styling language</span> the user agent
   may terminate these steps.</li>

   <li><p><a class="external" href="http://dev.w3.org/html5/spec/single-page.html#resolve-a-url" title="Resolve a URL">Resolve</a>
   the <a class="external" href="http://dev.w3.org/html5/spec/single-page.html#url">URL</a> specified by the
   <code>href</code> <a class="external" href="http://www.w3.org/TR/xml-stylesheet/#dt-pseudo-attribute">pseudo-attribute</a> and then
   <a class="external" href="http://dev.w3.org/html5/spec/single-page.html#fetch">fetch</a> it.</li>

   <li>
    <p>When the resource is available, the document is in
    <a class="external" href="http://dev.w3.org/html5/spec/single-page.html#quirks-mode">quirks mode</a>
    and the
    <a class="external" href="http://dev.w3.org/html5/spec/single-page.html#content-type" title="content-type">Content-Type metadata</a> of
    the resource is not a <span>supported styling language</span> change the
    <a class="external" href="http://dev.w3.org/html5/spec/single-page.html#content-type" title="content-type">Content-Type metadata</a> of the resource
    to <code>text/css</code>.</p>

    <p class="note">This step might never actually happen, but is included
    here in case other specifications change, to keep things consistent.</p>
   </li>

   <li><p>If the resource is not in a
   <span>supported styling language</span> terminate these steps.</li>

   <li>
    <p><a href="#create-a-style-sheet">Create a style sheet</a> with the following properties:</p>

    <dl>
     <dt><a href="#style-sheet-location">style sheet location</a></dt>
     <dd><p>The <a class="external" href="http://dev.w3.org/html5/spec/single-page.html#absolute-url">absolute URL</a> of the
     resource.</dd>

     <dt><a href="#style-sheet-parent">style sheet parent</a></dt>
     <dd><p><code>null</code></dd>

     <dt><a href="#style-sheet-owner-node">style sheet owner node</a></dt>
     <dd><p>The node.</dd>

     <dt><a href="#style-sheet-owner-css-rule">style sheet owner CSS rule</a></dt>
     <dd><p><code>null</code></dd>

     <dt><a href="#style-sheet-media">style sheet media</a></dt>
     <dd><p>The value of the <code>media</code> <a class="external" href="http://www.w3.org/TR/xml-stylesheet/#dt-pseudo-attribute">pseudo-attribute</a>
     if any, or the empty string otherwise.</dd>

     <dt><a href="#style-sheet-title">style sheet title</a></dt>
     <dd><p><var>title</var></dd>

     <dt><a href="#style-sheet-alternate-flag">style sheet alternate flag</a></dt>
     <dd><p>Set if the <code>alternate</code> <a class="external" href="http://www.w3.org/TR/xml-stylesheet/#dt-pseudo-attribute">pseudo-attribute</a>
     value is a <a class="external" href="http://dom.spec.whatwg.org/#case-sensitive">case-sensitive</a> match for
     "<code>yes</code>", or clear otherwise.
    </dl>
   </li>
  </ol>



  <!-- ........................................................................................................................ -->

  <h4 id="requirements-on-user-agents-implementing-the-http-link-header"><span class="secno">6.3.4 </span>Requirements on User Agents Implementing the HTTP
  <code>Link</code> Header</h4>

  <!-- XXX ref, one day -->

  <!-- XXX deal with media param -->

  <p>For each HTTP <code title="http-link">Link</code> header of which one
  of the link relation types is an
  <a class="external" href="http://dom.spec.whatwg.org/#ascii-case-insensitive">ASCII case-insensitive</a> match
  for "<code>stylesheet</code>" these steps
  must be run:</p>

  <ol>
   <li><p>Let <var>title</var> be the value of the first of all the
   <code>title</code> and <code>title*</code> parameters.
   If there are no such parameters it is the empty string.</li>

   <li><p>If one of the (other) link relation types is an
   <a class="external" href="http://dom.spec.whatwg.org/#ascii-case-insensitive">ASCII case-insensitive</a> match for
   "<code>alternate</code>" and <var>title</var> is the
   empty string terminate these steps.</li>

   <li><p><a class="external" href="http://dev.w3.org/html5/spec/single-page.html#resolve-a-url" title="Resolve a URL">Resolve</a>
   the specified <a class="external" href="http://dev.w3.org/html5/spec/single-page.html#url">URL</a> and
   <a class="external" href="http://dev.w3.org/html5/spec/single-page.html#fetch">fetch</a> it.</li>

   <li><p>When the resource is available, the document is in
   <a class="external" href="http://dev.w3.org/html5/spec/single-page.html#quirks-mode">quirks mode</a>
   and the <a class="external" href="http://dev.w3.org/html5/spec/single-page.html#content-type" title="content-type">Content-Type metadata</a> of
   the resource is not a <span>supported styling language</span> change the
   <a class="external" href="http://dev.w3.org/html5/spec/single-page.html#content-type" title="content-type">Content-Type metadata</a> of the resource
   to <code>text/css</code>.</li>

   <li><p>If the resource is not in a
   <span>supported styling language</span> terminate these steps.</li>

   <li>
    <p><a href="#create-a-style-sheet">Create a style sheet</a> with the following properties:</p>

    <dl>
     <dt><a href="#style-sheet-location">style sheet location</a></dt>
     <dd><p>The <a class="external" href="http://dev.w3.org/html5/spec/single-page.html#absolute-url">absolute URL</a> of the
     resource.</dd>

     <dt><a href="#style-sheet-owner-node">style sheet owner node</a></dt>
     <dd><p><code>null</code></dd>

     <dt><a href="#style-sheet-parent">style sheet parent</a></dt>
     <dd><p><code>null</code></dd>

     <dt><a href="#style-sheet-owner-css-rule">style sheet owner CSS rule</a></dt>
     <dd><p><code>null</code></dd>

     <dt><a href="#style-sheet-media">style sheet media</a></dt>
     <dd><p>The value of the first <code>media</code> parameter.</dd>
     <!-- XXX register media parameter? bah -->

     <dt><a href="#style-sheet-title">style sheet title</a></dt>
     <dd><p><var>title</var></dd>

     <dt><a href="#style-sheet-alternate-flag">style sheet alternate flag</a></dt>
     <dd><p>Set if one of the specified link relation type for this HTTP
     <code title="http-link">Link</code> header is an
     <a class="external" href="http://dom.spec.whatwg.org/#ascii-case-insensitive">ASCII case-insensitive</a> match for
     "<code>alternate</code>", or false otherwise.
    </dl>
   </li>
  </ol>

  <!-- ........................................................................................................................ -->
  <!-- ........................................................................................................................ -->

  <h3 id="css-rules"><span class="secno">6.4 </span>CSS Rules</h3>

  <p>A <dfn id="rule">CSS rule</dfn> is an abstract concept that
  denotes a rule as defined by the CSS specification. A
  <a href="#rule">CSS rule</a> is represented as an object that implements a subclass of
  the <code>CSSRule</code> interface, and which has the following
  associated state items:</p>

  <dl>
  <dt><dfn id="rule-type">rule type</dfn></dt>
  <dd><p>A non-negative integer associated with a particular type of rule.
  This item is initialized when a rule is created and must never change.</dd>

  <dt><dfn id="rule-text">rule text</dfn></dt>
  <dd><p>A text representation of the rule suitable for direct use in a style sheet.
  This item is initialized when a rule is created, and may change over the lifetime of the rule.</dd>

  <dt><dfn id="rule-parent">rule parent</dfn></dt>
  <dd><p>An optional reference to another, enclosing <a href="#rule">CSS rule</a>.
  If the rule has an enclosing rule when it is created, then this item is initialized to the enclosing rule; otherwise it is <code>null</code>.
  Subsequent to initialization, this item is reset to <code>null</code> if the rule becomes non-enclosed. Once reset to <code>null</code>, it must never change.</dd>

  <dt><dfn id="rule-style-sheet">rule parent style sheet</dfn></dt>
  <dd><p>An optional reference to an associated <a href="#css-style-sheet">CSS style sheet</a>.
  This item is initialized to reference an associated style sheet when the rule is created. Subsequent to initialization, this item
  is reset to <code>null</code> if the rule becomes disassociated from its initial style sheet. Once reset to <code>null</code>, it must never change.</dd>
  </dl>

  <p>In addition to the above state, each <a href="#rule">CSS rule</a> may be associated
  with other state in accordance with its <a href="#rule-type">rule type</a>.</p>

  <p>To <dfn id="parse-a-css-rule">parse a CSS rule</dfn> ...</p>

  <p class="issue">Should a rule be instantiated in OM if there is a parse error? To
  what extent should original (but non-valid) CSS text be captured in cssText?</p>

  <p>To <dfn id="serialize-a-css-rule">serialize a CSS rule</dfn>, perform one of the following in accordance with the <a href="#rule-type" title="rule type">rule's type</a>:</p>

  <dl class="switch">
   <dt><code>CSSStyleRule</code></dt>
   <dd>
    <p>The result of concatenating the following:</p>
    <ol>
     <li>The result of performing <a href="#serialize-a-group-of-selectors">serialize a group of selectors</a> on the rule's associated selectors.</li>
     <li>The string "<code> { </code>", i.e., a single SPACE (U+0020), followed by LEFT CURLY BRACKET (U+007B),
     followed by a single SPACE (U+0020).</li>
     <li>The result of performing <a href="#serialize-a-css-declaration-block">serialize a CSS declaration block</a> on the rule's associated declarations.</li>
     <li>If the rule is associated with one or more declarations, the string "<code> </code>", i.e., a single SPACE (U+0020).</li>
     <li>The string "<code>}</code>", RIGHT CURLY BRACKET (U+007D).
    </ol>
   </dd>

   <dt><code>CSSCharsetRule</code></dt>
   <dd>
    <p>The result of concatenating the following:</p>
    <ol>
     <li>The string "<code>@charset</code>" followed by a single SPACE (U+0020).</li>
     <li>The result of performing <a href="#serialize-a-string">serialize a string</a> on the <a class="external" href="http://dev.w3.org/html5/spec/single-page.html#preferred-mime-name">preferred MIME name</a> of the rule's encoding.</li>
     <li>The string "<code>;</code>", i.e., SEMICOLON (U+003B).
    </ol>
    <div class="example">
    <pre>@charset "UTF-8";</pre>
    </div>
   </dd>

   <dt><code>CSSImportRule</code></dt>
   <dd>
    <p>The result of concatenating the following:</p>
    <ol>
     <li>The string "<code>@import</code>" followed by a single SPACE (U+0020).</li>
     <li>The result of performing <a href="#serialize-a-url">serialize a URL</a> on the rule's location.</li>
     <li>If the rule's associated media list is not empty, a single SPACE (U+0020) followed by the
     result of performing <a href="#serialize-a-media-query-list">serialize a media query list</a> on the media list.
     <li>The string "<code>;</code>", i.e., SEMICOLON (U+003B).
    </ol>
    <div class="example">
    <pre>@import url("print.css") print;</pre>
    </div>
   </dd>

   <dt><code>CSSMediaRule</code></dt>
   <dd><p class="issue">...</dd>

   <dt><code>CSSFontFaceRule</code></dt>
   <dd><p class="issue">...</dd>

   <dt><code>CSSPageRule</code></dt>
   <dd><p class="issue">...</dd>

   <dt><code>CSSNamespaceRule</code></dt>
   <dd><p>The literal string "<code>@namespace</code>", followed by a single SPACE
   (U+0020), followed by the
   <a href="#serialize-an-identifier" title="serialize an identifier">identifier escaped</a> value of the
   <code title="dom-CSSNamespaceRule-prefix">prefix</code> attribute (if
   any), followed by a single SPACE (U+0020) if there is a prefix, followed by the
   <a href="#serialize-a-url" title="serialize a URL">URL escaped</a> value of the
   <code title="dom-CSSNamespaceRule-namespaceURI">namespaceURI</code>
   attribute, followed the character "<code>;</code>" (U+003B).</dd>
  </dl>

  <!-- ........................................................................................................................ -->

  <h4 id="the-cssrulelist-sequence"><span class="secno">6.4.1 </span>The <code>CSSRuleList</code> Sequence</h4>

  <p>The <code>CSSRuleList</code> sequence represents an ordered collection of CSS style rules.</p>
<pre class="idl">[[TBD - TYPEDEF]]
</pre>


  <!-- ........................................................................................................................ -->

  <h4 id="the-cssrule-interface"><span class="secno">6.4.2 </span>The <code>CSSRule</code> Interface</h4>

  <p>The <code>CSSRule</code> interface represents an abstract, base CSS style rule. Each  distinct CSS style rule type is represented by a distinct interface that  inherits from this interface.</p>
<pre class="idl"><span class="idlInterface" id="widl-def-CSSRule">interface <span class="idlInterfaceID">CSSRule</span> {
<span class="idlConst">    const <span class="idlConstType"><a>unsigned short</a></span> <span class="idlConstName"><a href="#widl-CSSRule-STYLE_RULE">STYLE_RULE</a></span> = <span class="idlConstValue">1</span>;</span>
<span class="idlConst">    const <span class="idlConstType"><a>unsigned short</a></span> <span class="idlConstName"><a href="#widl-CSSRule-CHARSET_RULE">CHARSET_RULE</a></span> = <span class="idlConstValue">2</span>;</span>
<span class="idlConst">    const <span class="idlConstType"><a>unsigned short</a></span> <span class="idlConstName"><a href="#widl-CSSRule-IMPORT_RULE">IMPORT_RULE</a></span> = <span class="idlConstValue">3</span>;</span>
<span class="idlConst">    const <span class="idlConstType"><a>unsigned short</a></span> <span class="idlConstName"><a href="#widl-CSSRule-MEDIA_RULE">MEDIA_RULE</a></span> = <span class="idlConstValue">4</span>;</span>
<span class="idlConst">    const <span class="idlConstType"><a>unsigned short</a></span> <span class="idlConstName"><a href="#widl-CSSRule-FONT_FACE_RULE">FONT_FACE_RULE</a></span> = <span class="idlConstValue">5</span>;</span>
<span class="idlConst">    const <span class="idlConstType"><a>unsigned short</a></span> <span class="idlConstName"><a href="#widl-CSSRule-PAGE_RULE">PAGE_RULE</a></span> = <span class="idlConstValue">6</span>;</span>
<span class="idlConst">    const <span class="idlConstType"><a>unsigned short</a></span> <span class="idlConstName"><a href="#widl-CSSRule-NAMESPACE_RULE">NAMESPACE_RULE</a></span> = <span class="idlConstValue">10</span>;</span>
<span class="idlAttribute">    readonly attribute <span class="idlAttrType"><a>unsigned short</a></span> <span class="idlAttrName"><a href="#widl-CSSRule-type">type</a></span>;</span>
<span class="idlAttribute">    attribute <span class="idlAttrType"><a>DOMString</a></span> <span class="idlAttrName"><a href="#widl-CSSRule-cssText">cssText</a></span>;</span>
<span class="idlAttribute">    readonly attribute <span class="idlAttrType"><a>CSSRule</a>?</span> <span class="idlAttrName"><a href="#widl-CSSRule-parentRule">parentRule</a></span>;</span>
<span class="idlAttribute">    readonly attribute <span class="idlAttrType"><a>CSSStyleSheet</a>?</span> <span class="idlAttrName"><a href="#widl-CSSRule-parentStyleSheet">parentStyleSheet</a></span>;</span>
};</span></pre>
<dl class="constants">
<dt class="constant" id="widl-CSSRule-STYLE_RULE">
<code>STYLE_RULE</code> of type <span class="idlConstType"><a>unsigned short</a></span>, with value 1</dt>
<dd>
<p>When the value of the <code>type</code> attribute is <code>STYLE_RULE</code>, then the object that implements    this interface must implement the <code>CSSStyleRule</code> interface.</dd>
<dt class="constant" id="widl-CSSRule-CHARSET_RULE">
<code>CHARSET_RULE</code> of type <span class="idlConstType"><a>unsigned short</a></span>, with value 2</dt>
<dd>
<p>When the value of the <code>type</code> attribute is <code>CHARSET_RULE</code>, then the object that implements    this interface must implement the <code>CSSCharsetRule</code> interface.</dd>
<dt class="constant" id="widl-CSSRule-IMPORT_RULE">
<code>IMPORT_RULE</code> of type <span class="idlConstType"><a>unsigned short</a></span>, with value 3</dt>
<dd>
<p>When the value of the <code>type</code> attribute is <code>IMPORT_RULE</code>, then the object that implements    this interface must implement the <code>CSSImportRule</code> interface.</dd>
<dt class="constant" id="widl-CSSRule-MEDIA_RULE">
<code>MEDIA_RULE</code> of type <span class="idlConstType"><a>unsigned short</a></span>, with value 4</dt>
<dd>
<p>When the value of the <code>type</code> attribute is <code>MEDIA_RULE</code>, then the object that implements    this interface must implement the <code>CSSMediaRule</code> interface.</dd>
<dt class="constant" id="widl-CSSRule-FONT_FACE_RULE">
<code>FONT_FACE_RULE</code> of type <span class="idlConstType"><a>unsigned short</a></span>, with value 5</dt>
<dd>
<p>When the value of the <code>type</code> attribute is <code>FONT_FACE_RULE</code>, then the object that implements    this interface must implement the <code>CSSFontFaceRule</code> interface.</dd>
<dt class="constant" id="widl-CSSRule-PAGE_RULE">
<code>PAGE_RULE</code> of type <span class="idlConstType"><a>unsigned short</a></span>, with value 6</dt>
<dd>
<p>When the value of the <code>type</code> attribute is <code>PAGE_RULE</code>, then the object that implements    this interface must implement the <code>CSSPageRule</code> interface.</dd>
<dt class="constant" id="widl-CSSRule-NAMESPACE_RULE">
<code>NAMESPACE_RULE</code> of type <span class="idlConstType"><a>unsigned short</a></span>, with value 10</dt>
<dd>
<p>When the value of the <code>type</code> attribute is <code>NAMESPACE_RULE</code>, then the object that implements    this interface must implement the <code>CSSNamespaceRule</code> interface.</dd>
</dl>
<dl class="attributes">
<dt class="attribute" id="widl-CSSRule-type">
<code>type</code> of type <span class="idlAttrType"><a>unsigned short</a></span>, readonly</dt>
<dd>
<p>The <code>type</code> attribute must return one of the following values:     <code>STYLE_RULE</code>,     <code>IMPORT_RULE</code>,     <code>MEDIA_RULE</code>,     <code>FONT_FACE_RULE</code>,     <code>PAGE_RULE</code>,     <code>NAMESPACE_RULE</code>,     or a registered extension value.    </p>    <p>The value 0, formerly known as <code>UNKNOWN_RULE</code>, is made     obsolete by this specification. This value will not be re-allocated in the future and shall remain reserved.</p>    <p class="note">Constants for new and proprietary rule types are coordinated     on the <a href="http://wiki.csswg.org/spec/cssom-constants">CSSOM Constants</a> wiki page.</dd>
<dt class="attribute" id="widl-CSSRule-cssText">
<code>cssText</code> of type <span class="idlAttrType"><a>DOMString</a></span></dt>
<dd>
<p>The <code>cssText</code> attribute must return a <a href="#serialize-a-css-rule" title="serialize a CSS rule">serialization</a> of the    <a href="#rule">CSS rule</a>.</p>    <p>On setting the <code>cssText</code> attribute these steps must be run:</p>    <ol>     <li><p><a href="#parse-a-css-rule" title="Parse a CSS rule">Parse</a> the value.</li>     <li><p>If parsing failed terminate this algorithm.</li>     <li><p>If the <code title="dom-CSSRule-type">type</code> of the new     object does not match the <code title="dom-CSSRule-type">type</code> of     the current object     <a class="external" href="http://dom.spec.whatwg.org/#concept-throw" title="concept-throw">throw</a> an     '<code class="external"><a href="http://dom.spec.whatwg.org/#invalidmodificationerror">InvalidModificationError</a></code>' exception.</li>     <li><p>Replace the current object with the new object.</li>    </ol></dd>
<dt class="attribute" id="widl-CSSRule-parentRule">
<code>parentRule</code> of type <span class="idlAttrType"><a>CSSRule</a>?</span>, readonly</dt>
<dd>
<p>The <code>parentRule</code> attribute must return the nearest enclosing rule of the current rule or <code>null</code> if    there is none. If a value other than <code>null</code> is ever returned, than that same value must always be returned on each get access.</p>    <p class="note">For example, <code>@media</code> can enclose a rule, in which case <code>ownerRule</code> would    be non-null; in cases where there is no enclosing rule, <code>ownerRule</code> will be <code>null</code>.</dd>
<dt class="attribute" id="widl-CSSRule-parentStyleSheet">
<code>parentStyleSheet</code> of type <span class="idlAttrType"><a>CSSStyleSheet</a>?</span>, readonly</dt>
<dd>
<p>The <code>parentStyleSheet</code> attribute must return the <code>CSSStyleSheet</code> object that contains the the    current rule or <code>null</code> if there is none.</p>    <p class="note">The only circumstance where <code>null</code> is returned is in the case that    <code>CSSStyleSheet.prototype.deleteRule</code> has been invoked to <a href="#remove-a-css-rule">remove a CSS rule</a>    from a CSS style sheet, in which case its <code>parentStyleSheet</code> property will have been set to <code>null</code>.</p>    <p class="note">Removing an <code>Node</code> that implements the <code>LinkStyle</code> interface from a <code>Document</code> instance    does not (by itself) cause the <code>CSSStyleSheet</code> referenced by a <code>CSSRule</code> to be unreachable; that is, as long as    there exists a reachable reference to a <code>CSSRule</code> object, then its <code>parentStyleSheet</code> property remains viable    if it has not been previously removed from the style sheet by using the <code>deleteRule</code> operation.</dd>
</dl>


  <!-- ........................................................................................................................ -->

  <h4 id="the-cssstylerule-interface"><span class="secno">6.4.3 </span>The <code>CSSStyleRule</code> Interface</h4>

  <p>The <code>CSSStyleRule</code> interface represents a rule set.</p>
<pre class="idl"><span class="idlInterface" id="widl-def-CSSStyleRule">interface <span class="idlInterfaceID">CSSStyleRule</span> : <span class="idlSuperclass"><a class="idlType" href="#widl-def-CSSRule"><code>CSSRule</code></a></span> {
<span class="idlAttribute">    attribute <span class="idlAttrType"><a>DOMString</a></span> <span class="idlAttrName"><a href="#widl-CSSStyleRule-selectorText">selectorText</a></span>;</span>
<span class="idlAttribute">    readonly attribute <span class="idlAttrType"><a>CSSStyleDeclaration</a></span> <span class="idlAttrName"><a href="#widl-CSSStyleRule-style">style</a></span>;</span>
};</span></pre>
<dl class="attributes">
<dt class="attribute" id="widl-CSSStyleRule-selectorText">
<code>selectorText</code> of type <span class="idlAttrType"><a>DOMString</a></span></dt>
<dd>
<p>The <code>selectorText</code> attribute, on getting, must return the result of <a href="#serialize-a-group-of-selectors" title="serialize a group of selectors">serializing</a> the associated    <span>group of selectors</span>.</p>    <p>On setting the <code>selectorText</code> attribute these steps must be run:</p>    <ol>      <li><p>Run the <a href="#parse-a-group-of-selectors">parse a group of selectors</a> algorithm on the given value.</li>      <li><p>If the algorithm returns a non-null value replace the associated <span>group of selectors</span> with the returned value.</li>      <li><p>Otherwise, if the algorithm returns a <code>null</code> value, do nothing.</li>    </ol></dd>
<dt class="attribute" id="widl-CSSStyleRule-style">
<code>style</code> of type <span class="idlAttrType"><a>CSSStyleDeclaration</a></span>, readonly</dt>
<dd>
<p>The <code>style</code> attribute must return a <code>CSSStyleDeclaration</code> object for the rule set.</dd>
</dl>


  <!-- ........................................................................................................................ -->

  <h4 id="the-csscharsetrule-interface"><span class="secno">6.4.4 </span>The <code>CSSCharsetRule</code> Interface</h4>

  

  <!-- ........................................................................................................................ -->

  <h4 id="the-cssimportrule-interface"><span class="secno">6.4.5 </span>The <code>CSSImportRule</code> Interface</h4>

  <p>The <code>CSSImportRule</code> interface represents an <code>@import</code> rule.</p>
<pre class="idl"><span class="idlInterface" id="widl-def-CSSImportRule">interface <span class="idlInterfaceID">CSSImportRule</span> : <span class="idlSuperclass"><a class="idlType" href="#widl-def-CSSRule"><code>CSSRule</code></a></span> {
<span class="idlAttribute">    readonly attribute <span class="idlAttrType"><a>DOMString</a></span> <span class="idlAttrName"><a href="#widl-CSSImportRule-href">href</a></span>;</span>
<span class="idlAttribute">    readonly attribute <span class="idlAttrType"><a>MediaList</a></span> <span class="idlAttrName"><a href="#widl-CSSImportRule-media">media</a></span>;</span>
<span class="idlAttribute">    readonly attribute <span class="idlAttrType"><a>CSSStyleSheet</a></span> <span class="idlAttrName"><a href="#widl-CSSImportRule-styleSheet">styleSheet</a></span>;</span>
};</span></pre>
<dl class="attributes">
<dt class="attribute" id="widl-CSSImportRule-href">
<code>href</code> of type <span class="idlAttrType"><a>DOMString</a></span>, readonly</dt>
<dd>
<p>The <code>href</code> attribute must return the <span>URL</span> specified by the <code>@import</code> rule.</p>    <p class="note">To get the resolved <span>URL</span> use the <code title="dom-StyleSheet-href">href</code>    attribute of the associated <span>style sheet</span>.</dd>
<dt class="attribute" id="widl-CSSImportRule-media">
<code>media</code> of type <span class="idlAttrType"><a>MediaList</a></span>, readonly</dt>
<dd>
<p>The <code>media</code> attribute must return the value of the <code title="dom-StyleSheet-media">media</code>    attribute of the associated <span>style sheet</span>.</dd>
<dt class="attribute" id="widl-CSSImportRule-styleSheet">
<code>styleSheet</code> of type <span class="idlAttrType"><a>CSSStyleSheet</a></span>, readonly</dt>
<dd>
<p>The <code>styleSheet</code> attribute must return the associated <span>style sheet</span>.</p>    <p class="note">If loading of the style sheet fails its <code title="dom-CSSStyleSheet-cssRules">cssRules</code>    list is simply empty, i.e., an <code>@import</code> rule always has an associated <span>style sheet</span>.</dd>
</dl>


  <!-- ........................................................................................................................ -->

  <h4 id="the-cssmediarule-interface"><span class="secno">6.4.6 </span>The <code>CSSMediaRule</code> Interface</h4>

  <p>The <code>CSSMediaRule</code> interface represents a <code>@media</code> rule.</p>
<pre class="idl"><span class="idlInterface" id="widl-def-CSSMediaRule">interface <span class="idlInterfaceID">CSSMediaRule</span> : <span class="idlSuperclass"><a class="idlType" href="#widl-def-CSSRule"><code>CSSRule</code></a></span> {
<span class="idlAttribute">    readonly attribute <span class="idlAttrType"><a>MediaList</a></span> <span class="idlAttrName"><a href="#widl-CSSMediaRule-media">media</a></span>;</span>
<span class="idlAttribute">    readonly attribute <span class="idlAttrType"><a>CSSRuleList</a></span> <span class="idlAttrName"><a href="#widl-CSSMediaRule-cssRules">cssRules</a></span>;</span>
<span class="idlMethod">    <span class="idlMethType"><a>unsigned long</a></span> <span class="idlMethName"><a href="#widl-CSSMediaRule-insertRule-unsigned-long-DOMString-rule-unsigned-long-index">insertRule</a></span> (<span class="idlParam"><span class="idlParamType"><a>DOMString</a></span> <span class="idlParamName">rule</span></span>, <span class="idlParam"><span class="idlParamType"><a>unsigned long</a></span> <span class="idlParamName">index</span></span>);</span>
<span class="idlMethod">    <span class="idlMethType"><a>void</a></span> <span class="idlMethName"><a href="#widl-CSSMediaRule-deleteRule-void-unsigned-long-index">deleteRule</a></span> (<span class="idlParam"><span class="idlParamType"><a>unsigned long</a></span> <span class="idlParamName">index</span></span>);</span>
};</span></pre>
<dl class="attributes">
<dt class="attribute" id="widl-CSSMediaRule-media">
<code>media</code> of type <span class="idlAttrType"><a>MediaList</a></span>, readonly</dt>
<dd>
<p>The <code>media</code> attribute must return a <code>MediaList</code> object for the list of media queries specified    with the <code>@media</code> rule.</dd>
<dt class="attribute" id="widl-CSSMediaRule-cssRules">
<code>cssRules</code> of type <span class="idlAttrType"><a>CSSRuleList</a></span>, readonly</dt>
<dd>
<p>The <code>cssRules</code> attribute must return a <code>CSSRuleList</code> object for the list of CSS rules specified    with the <code>@media</code> rule.</dd>
</dl>
<dl class="methods">
<dt class="method" id="widl-CSSMediaRule-insertRule-unsigned-long-DOMString-rule-unsigned-long-index">
<code>insertRule</code> (<span class="idlParam"><span class="idlParamType"><a>DOMString</a></span> <span class="idlParamName">rule</span></span>, <span class="idlParam"><span class="idlParamType"><a>unsigned long</a></span> <span class="idlParamName">index</span></span>), returns <span class="idlMethType"><a>unsigned long</a></span></dt>
<dd>
<p>The <code>insertRule</code> operation must <a href="#insert-a-css-rule">insert a CSS rule</a> <var>rule</var> into the CSS rule list    returned by <code title="dom-CSSMediaRule-cssRules">cssRules</code> at <var>index</var>.</dd>
<dt class="method" id="widl-CSSMediaRule-deleteRule-void-unsigned-long-index">
<code>deleteRule</code> (<span class="idlParam"><span class="idlParamType"><a>unsigned long</a></span> <span class="idlParamName">index</span></span>), returns <span class="idlMethType"><a>void</a></span></dt>
<dd>
<p>The <code>deleteRule</code> operation must <a href="#remove-a-css-rule">remove a CSS rule</a> from the CSS rule list returned by    <code title="dom-CSSMediaRule-cssRules">cssRules</code> at <var>index</var>.</dd>
</dl>


  <!-- ........................................................................................................................ -->

  <h4 id="the-cssfontfacerule-interface"><span class="secno">6.4.7 </span>The <code>CSSFontFaceRule</code> Interface</h4>

  <p>The <code>CSSFontFaceRule</code> interface represents a <code>@font-face</code> rule.</p>
<pre class="idl"><span class="idlInterface" id="widl-def-CSSFontFaceRule">interface <span class="idlInterfaceID">CSSFontFaceRule</span> : <span class="idlSuperclass"><a class="idlType" href="#widl-def-CSSRule"><code>CSSRule</code></a></span> {
<span class="idlAttribute">    readonly attribute <span class="idlAttrType"><a>CSSStyleDeclaration</a></span> <span class="idlAttrName"><a href="#widl-CSSFontFaceRule-style">style</a></span>;</span>
};</span></pre>
<dl class="attributes">
<dt class="attribute" id="widl-CSSFontFaceRule-style">
<code>style</code> of type <span class="idlAttrType"><a>CSSStyleDeclaration</a></span>, readonly</dt>
<dd>
<p>The <code>style</code> attribute must return a <code>CSSStyleDeclaration</code> block that contains the property    declarations specified within the <code>@font-face</code> rule.</dd>
</dl>


  <!-- ........................................................................................................................ -->

  <h4 id="the-csspagerule-interface"><span class="secno">6.4.8 </span>The <code>CSSPageRule</code> Interface</h4>
 
  <p>The <code>CSSPageRule</code> interface represents a <code>@page</code> rule.</p>  <p class="note">Need to define the rules for  <dfn id="parse-a-css-page-selector">parse a CSS page selector</dfn> and  <dfn id="serialize-a-css-page-selector">serialize a CSS page selector</dfn>.</p>
<pre class="idl"><span class="idlInterface" id="widl-def-CSSPageRule">interface <span class="idlInterfaceID">CSSPageRule</span> : <span class="idlSuperclass"><a class="idlType" href="#widl-def-CSSRule"><code>CSSRule</code></a></span> {
<span class="idlAttribute">    attribute <span class="idlAttrType"><a>DOMString</a></span> <span class="idlAttrName"><a href="#widl-CSSPageRule-selectorText">selectorText</a></span>;</span>
<span class="idlAttribute">    readonly attribute <span class="idlAttrType"><a>CSSStyleDeclaration</a></span> <span class="idlAttrName"><a href="#widl-CSSPageRule-style">style</a></span>;</span>
};</span></pre>
<dl class="attributes">
<dt class="attribute" id="widl-CSSPageRule-selectorText">
<code>selectorText</code> of type <span class="idlAttrType"><a>DOMString</a></span></dt>
<dd>
<p>The <code>selectorText</code> attribute, on getting, must return the result of <a href="#serialize-a-css-page-selector" title="serialize a CSS page selector">serializing</a>    the associated <span>CSS page selector</span>.</p>    <p>On setting the <code>selectorText</code> attribute these steps must be run:</p>    <ol>    <li><p>Run the <a href="#parse-a-css-page-selector">parse a CSS page selector</a> algorithm on the given value.</li>    <li><p>If the algorithm returns a non-null value replace the associated <span>CSS page selector</span> with the returned value.</li>    <li><p>Otherwise, if the algorithm returns a <code>null</code> value, do nothing.</li>    </ol></dd>
<dt class="attribute" id="widl-CSSPageRule-style">
<code>style</code> of type <span class="idlAttrType"><a>CSSStyleDeclaration</a></span>, readonly</dt>
<dd>
<p>The <code>style</code> attribute must return a <code>CSSStyleDeclaration</code> for the <code>@page</code> rule.</dd>
</dl>


  <!-- ........................................................................................................................ -->

  <h4 id="the-cssnamespacerule-interface"><span class="secno">6.4.9 </span>The <code>CSSNamespaceRule</code> Interface</h4>

  <p>The <code>CSSNamespaceRule</code> interface represents a <code>@namespace</code> rule.</p>
<pre class="idl"><span class="idlInterface" id="widl-def-CSSNamespaceRule">interface <span class="idlInterfaceID">CSSNamespaceRule</span> : <span class="idlSuperclass"><a class="idlType" href="#widl-def-CSSRule"><code>CSSRule</code></a></span> {
<span class="idlAttribute">    readonly attribute <span class="idlAttrType"><a>DOMString</a></span> <span class="idlAttrName"><a href="#widl-CSSNamespaceRule-namespaceURI">namespaceURI</a></span>;</span>
<span class="idlAttribute">    readonly attribute <span class="idlAttrType"><a>DOMString</a>?</span> <span class="idlAttrName"><a href="#widl-CSSNamespaceRule-prefix">prefix</a></span>;</span>
};</span></pre>
<dl class="attributes">
<dt class="attribute" id="widl-CSSNamespaceRule-namespaceURI">
<code>namespaceURI</code> of type <span class="idlAttrType"><a>DOMString</a></span>, readonly</dt>
<dd>
<p>The <code>namespaceURI</code> attribute must return the namespace of the <code>@namespace</code> rule.</dd>
<dt class="attribute" id="widl-CSSNamespaceRule-prefix">
<code>prefix</code> of type <span class="idlAttrType"><a>DOMString</a>?</span>, readonly</dt>
<dd>
<p>The <code>prefix</code> attribute must return the prefix of the <code>@namespace</code> rule or the    empty string if there is no prefix.</dd>
</dl>


  <!-- ........................................................................................................................ -->
  <!-- ........................................................................................................................ -->

  <h3 id="css-declaration-blocks"><span class="secno">6.5 </span>CSS Declaration Blocks</h3>

  <p>A <dfn id="css-declaration-block">CSS declaration block</dfn> is an ordered collection of CSS
  properties with their associated values, also named CSS declarations. In
  the DOM a <a href="#css-declaration-block">CSS declaration block</a> is a
  <code>CSSStyleDeclaration</code> object. A
  <a href="#css-declaration-block">CSS declaration block</a> has two associated properties:</p>

  <dl>
   <dt><dfn id="css-declaration-block-readonly-flag">CSS declaration block readonly flag</dfn></dt>
   <dd><p>Clear if the object can be manipulated. Set if it can not be
   manipulated. Unless otherwise stated it is clear.</dd>

   <dt><dfn id="css-declaration-block-declarations">CSS declaration block declarations</dfn></dt>
   <dd><p>The CSS declarations associated with the object.</dd>
  </dl>

  <p class="note">The <a href="#css-declaration-block-declarations">CSS declaration block declarations</a> are
  ordered. This matters for the
  <code title="dom-CSSStyleDeclaration-item">item()</code> method.</p>

  <p>To <dfn id="parse-a-css-declaration-block">parse a CSS declaration block</dfn> ...</p>

  <p class="issue">What should be captured in the cssText of a declaration block which fails
  to parse?</p>

  <p>To <dfn id="serialize-a-css-declaration-block">serialize a CSS declaration block</dfn>
  represented by a <code>CSSStyleDeclarations</code> instance named <var>d</var>,
  let <var>s</var> be the empty string, then run the steps below:</p>

  <ol>
    <li><p>If <code><var>d</var>.length</code> is zero (0), then return <var>s</var>.</li>
    <li><p>For each <var>i</var> from zero (0) through <code><var>d</var>.length</code> - 1 (inclusive), perform the following sub-steps:</p>
    <ol>
      <li><p>Let <var>n</var> be the value returned by <code><var>d</var>.item(<var>i</var>)</code>.</li>
      <li><p>Let <var>v</var> be the value returned by <code><var>d</var>.getPropertyValue(<var>n</var>)</code>.</li>
      <li><p>If <var>v</var> is the empty string, then continue.</li>
      <li><p>Otherwise (<var>v</var> is non-empty), perform the following sub-steps:</p>
          <ol>
            <li><p>If <var>s</var> is not empty, then append a single SPACE (U+0020) to <var>s</var>.</li>
            <li><p>Append <var>n</var> to <var>s</var>.</li>
            <li><p>Append COLON (U+003A) followed by a single SPACE (U+0020), i.e., "<code>: </code>", to <var>s</var>.</li>
            <li><p>Append <var>v</var> to <var>s</var>.</li>
          </ol>
      </li>
      <li><p>Let <var>p</var> be the value returned by <code><var>d</var>.getPropertyPriority(<var>n</var>)</code>.</li>
      <li><p>If <var>p</var> is not the empty string, then perform the following sub-steps:</p>
          <ol>
            <li><p>Append a single SPACE (U+0020) followed by EXCLAMATION MARK (U+0021), i.e., "<code> !</code>", to <var>s</var>.</li>
            <li><p>Append <var>p</var> to <var>s</var>.</li>
          </ol>
      </li>
      <li><p>Append SEMICOLON (U+003B), i.e., "<code>;</code>", to <var>s</var>.</li>
    </ol>
    </li>
    <li><p>Return <var>s</var>.</li>
  </ol>

  <p class="note">The serialization of an empty CSS declaration block is the empty string.</p>

  <p class="note">The serialization of a non-empty CSS declaration block does not include any surrounding whitespace, i.e., no whitepsace appears
  before the first property name and no whitespace appears after the final semicolon delimiter that follows the last property value.</p>

  <!-- ........................................................................................................................ -->

  <h4 id="the-cssstyledeclaration-interface"><span class="secno">6.5.1 </span>The <code>CSSStyleDeclaration</code> Interface</h4>

  <p>The <code>CSSStyleDeclaration</code> interface represents a <a href="#css-declaration-block">CSS declaration block</a>, including its underlying state, where this    underlying state depends upon the source of the <code>CSSStyleDeclaration</code> instance.</p>
<pre class="idl"><span class="idlInterface" id="widl-def-CSSStyleDeclaration">interface <span class="idlInterfaceID">CSSStyleDeclaration</span> {
<span class="idlAttribute">    attribute <span class="idlAttrType"><a>DOMString</a></span> <span class="idlAttrName"><a href="#widl-CSSStyleDeclaration-cssText">cssText</a></span>;</span>
<span class="idlAttribute">    readonly attribute <span class="idlAttrType"><a>unsigned long</a></span> <span class="idlAttrName"><a href="#widl-CSSStyleDeclaration-length">length</a></span>;</span>
<span class="idlMethod">    <span class="idlMethType"><a>DOMString</a></span> <span class="idlMethName"><a href="#widl-CSSStyleDeclaration-item-DOMString-unsigned-long-index">item</a></span> (<span class="idlParam"><span class="idlParamType"><a>unsigned long</a></span> <span class="idlParamName">index</span></span>);</span>
<span class="idlMethod">    <span class="idlMethType"><a>DOMString</a></span> <span class="idlMethName"><a href="#widl-CSSStyleDeclaration-getPropertyValue-DOMString-DOMString-property">getPropertyValue</a></span> (<span class="idlParam"><span class="idlParamType"><a>DOMString</a></span> <span class="idlParamName">property</span></span>);</span>
<span class="idlMethod">    <span class="idlMethType"><a>DOMString</a></span> <span class="idlMethName"><a href="#widl-CSSStyleDeclaration-getPropertyPriority-DOMString-DOMString-property">getPropertyPriority</a></span> (<span class="idlParam"><span class="idlParamType"><a>DOMString</a></span> <span class="idlParamName">property</span></span>);</span>
<span class="idlMethod">    <span class="idlMethType"><a>void</a></span> <span class="idlMethName"><a href="#widl-CSSStyleDeclaration-setProperty-void-DOMString-property-DOMString-value-DOMString-priority">setProperty</a></span> (<span class="idlParam"><span class="idlParamType"><a>DOMString</a></span> <span class="idlParamName">property</span></span>, <span class="idlParam"><span class="idlParamType"><a>DOMString</a></span> <span class="idlParamName">value</span></span>, <span class="idlParam">optional <span class="idlParamType"><a>DOMString</a></span> <span class="idlParamName">priority</span></span>);</span>
<span class="idlMethod">    <span class="idlMethType"><a>DOMString</a></span> <span class="idlMethName"><a href="#widl-CSSStyleDeclaration-removeProperty-DOMString-DOMString-property">removeProperty</a></span> (<span class="idlParam"><span class="idlParamType"><a>DOMString</a></span> <span class="idlParamName">property</span></span>);</span>
<span class="idlAttribute">    readonly attribute <span class="idlAttrType"><a>CSSRule</a>?</span> <span class="idlAttrName"><a href="#widl-CSSStyleDeclaration-parentRule">parentRule</a></span>;</span>
};</span></pre>
<dl class="attributes">
<dt class="attribute" id="widl-CSSStyleDeclaration-cssText">
<code>cssText</code> of type <span class="idlAttrType"><a>DOMString</a></span></dt>
<dd>
<p>The <code>cssText</code> attribute must return the result of <a href="#serialize-a-css-declaration-block" title="serialize a CSS declaration block">serializing</a> the    <a href="#css-declaration-block-declarations">CSS declaration block declarations</a>.</p>    <p>Setting the <code>cssText</code> attribute must run these steps:    <ol>      <li><p>If the <a href="#css-declaration-block-readonly-flag">CSS declaration block readonly flag</a> is set, <a class="external" href="http://dom.spec.whatwg.org/#concept-throw" title="concept-throw">throw</a> a        <code class="external"><a href="http://dom.spec.whatwg.org/#nomodificationallowederror">NoModificationAllowedError</a></code> exception and terminate these steps.</li>      <li><p>Empty the <a href="#css-declaration-block-declarations">CSS declaration block declarations</a>.</li>      <li><p><a href="#parse-a-css-declaration-block" title="Parse a CSS declaration block">Parse</a> the given value and, if the return value is not <code>null</code>, insert it into the        <a href="#css-declaration-block-declarations">CSS declaration block declarations</a>.</li>    </ol></dd>
<dt class="attribute" id="widl-CSSStyleDeclaration-length">
<code>length</code> of type <span class="idlAttrType"><a>unsigned long</a></span>, readonly</dt>
<dd>
<p>The <code>length</code> attribute must return the number of declarations in the <span>collection of CSS declarations</span>.</dd>
<dt class="attribute" id="widl-CSSStyleDeclaration-parentRule">
<code>parentRule</code> of type <span class="idlAttrType"><a>CSSRule</a>?</span>, readonly</dt>
<dd>
<p>The <code>parentRule</code> attribute must return the <code>CSSrule</code> object the <code>CSSStyleDeclaration</code> is object is associated with    or <code>null</code> if it is not associated with a <code>CSSrule</code> object.</dd>
</dl>
<dl class="methods">
<dt class="method" id="widl-CSSStyleDeclaration-item-DOMString-unsigned-long-index">
<code>item</code> (<span class="idlParam"><span class="idlParamType"><a>unsigned long</a></span> <span class="idlParamName">index</span></span>), returns <span class="idlMethType"><a>DOMString</a></span></dt>
<dd>
<p>The <code>item</code> operation must return the name of the property at position <var>index</var>.</dd>
<dt class="method" id="widl-CSSStyleDeclaration-getPropertyValue-DOMString-DOMString-property">
<code>getPropertyValue</code> (<span class="idlParam"><span class="idlParamType"><a>DOMString</a></span> <span class="idlParamName">property</span></span>), returns <span class="idlMethType"><a>DOMString</a></span></dt>
<dd>
<p>The <code>getPropertyValue</code> operation must ...</dd>
<dt class="method" id="widl-CSSStyleDeclaration-getPropertyPriority-DOMString-DOMString-property">
<code>getPropertyPriority</code> (<span class="idlParam"><span class="idlParamType"><a>DOMString</a></span> <span class="idlParamName">property</span></span>), returns <span class="idlMethType"><a>DOMString</a></span></dt>
<dd>
<p>The <code>getPropertyPriority</code> operation, when invoked, if <var>property</var> is an <a class="external" href="http://dom.spec.whatwg.org/#ascii-case-insensitive">ASCII case-insensitive</a>    match for a property that has a priority user agents must return the canonical priority of that property as given in the    syntax definition. Otherwise, the empty string must be returned.</p>    <p class="example">E.g. for <code>background-color:lime !IMPORTANT</code> the return value would be '<code>important</code>'.</dd>
<dt class="method" id="widl-CSSStyleDeclaration-setProperty-void-DOMString-property-DOMString-value-DOMString-priority">
<code>setProperty</code> (<span class="idlParam"><span class="idlParamType"><a>DOMString</a></span> <span class="idlParamName">property</span></span>, <span class="idlParam"><span class="idlParamType"><a>DOMString</a></span> <span class="idlParamName">value</span></span>, <span class="idlParam">optional <span class="idlParamType"><a>DOMString</a></span> <span class="idlParamName">priority</span></span>), returns <span class="idlMethType"><a>void</a></span></dt>
<dd>
<p>The <code>setProperty</code> operation must run these steps:</p>    <ol>      <li><p>If the <a href="#css-declaration-block-readonly-flag">CSS declaration block readonly flag</a> is set, <a class="external" href="http://dom.spec.whatwg.org/#concept-throw" title="concept-throw">throw</a>        an '<code class="external"><a href="http://dom.spec.whatwg.org/#nomodificationallowederror">NoModificationAllowedError</a></code>' and terminate these steps.</li>      <li><p>If <var>property</var> is not an <a class="external" href="http://dom.spec.whatwg.org/#ascii-case-insensitive">ASCII case-insensitive</a> match for a supported property,        terminate this algorithm.</li>      <li><p>If <var>value</var> is the empty string, invoke <code title="dom-CSSStyleDeclaration-removeProperty">removeProperty()</code>        with <var>property</var> as argument and terminate this algorithm.</li>      <li><p>If the <var>priority</var> argument has been omitted let <var>priority</var> be the empty string.</li>      <li><p>If <var>priority</var> is neither a valid priority nor the empty string terminate this algorithm.</li>      <li>        <p>If <a href="#parse-a-css-value" title="parse a CSS value">parsing the <var>value</var></a> returns <code>null</code> terminate this algorithm.        <p class="note"><var>value</var> can not include '<code>!important</code>'.</p>      </li>      <li><p>Finally, set <var>property</var> to <var>value</var> with priority <var>priority</var> when <var>priority</var>        is not the empty string. Otherwise set <var>property</var> to <var>value</var>.</li>    </ol></dd>
<dt class="method" id="widl-CSSStyleDeclaration-removeProperty-DOMString-DOMString-property">
<code>removeProperty</code> (<span class="idlParam"><span class="idlParamType"><a>DOMString</a></span> <span class="idlParamName">property</span></span>), returns <span class="idlMethType"><a>DOMString</a></span></dt>
<dd>
<p>The <code>removeProperty</code> operation must run these steps:</p>    <ol>     <li><p>If the <a href="#css-declaration-block-readonly-flag">CSS declaration block readonly flag</a> is set, <a class="external" href="http://dom.spec.whatwg.org/#concept-throw" title="concept-throw">throw</a> a       '<code class="external"><a href="http://dom.spec.whatwg.org/#nomodificationallowederror">NoModificationAllowedError</a></code>' and terminate these steps.</li>     <li><p>If <var>property</var> is an <a class="external" href="http://dom.spec.whatwg.org/#ascii-case-insensitive">ASCII case-insensitive</a> match for a property of a declaration in the       <span>collection of CSS declarations</span> remove the declaration.</li>    </ol></dd>
</dl>


  <hr>

  <p>For the table below, the IDL attribute in the first column
  must return the result of invoking
  <code title="dom-CSSStyleDeclaration-getPropertyValue">getPropertyValue()</code>
  with as argument the CSS property given in the second column on the same
  row.</p>

  <p>Similarly for the table below, setting the IDL attribute in the
  first column must invoke
  <code title="dom-CSSStyleDeclaration-setProperty">setProperty()</code>
  with as first argument the CSS property given in the second column on the
  same row, as second argument the given value, and no third argument. Any
  exceptions thrown must be re-thrown.</p>

  <p class="issue">Restore the entries for the following table or resurrect
  CSS2Properties (or similar) or define in general terms using prose or ...</p>

  <table>
   <thead>
    <tr>
     <th>IDL attribute
     <th>CSS property
   <tbody>
<!--CSSOM-DECLARATIONTABLE-->
  </table>

<!--
  <h4>CSS Properties</h4>

  <p>The DOM attribute name of a CSS property can be found by using the
  following algorithm:</p>

  <ol>
   <li>Let <var>r</var> be the CSS property to be
   converted.</li>

   <li>Uppercase the first character after every U+002D (<code>-</code>) in
   <var>r</var>.</li>

   <li>Remove every U+002D (<code>-</code>) in <var>r</var>.</li>

   <li>Return <var>r</var>.</li>
  </ol>

  <p class="note">This means that
  <code>-<var>vendor</var>-<var>property</var></code>
  becomes
  <code><var><strong>V</strong>endor</var><var><strong>P</strong>roperty</var></code>
  for instance.</p>
-->

  <!-- ........................................................................................................................ -->
  <!-- ........................................................................................................................ -->

  <h3 id="css-values"><span class="secno">6.6 </span>CSS Values</h3>

  <!-- ........................................................................................................................ -->

  <h4 id="parsing-css-values"><span class="secno">6.6.1 </span>Parsing CSS Values</h4>

  <p>To <dfn id="parse-a-css-value">parse a CSS value</dfn> for a given
  <var>property</var> means to a parse the given value according to
  the definition of the property that is an
  <a class="external" href="http://dom.spec.whatwg.org/#ascii-case-insensitive">ASCII case-insensitive</a> match for
  <var>property</var> in the CSS specification. If the given value
  is <span>ignored</span> return <code>null</code>. Otherwise return the CSS value for
  the given <var>property</var>.</p>

  <p class="note">"<code>!important</code>" declarations are not
  part of the property value space and will therefore cause
  <a href="#parse-a-css-value">parse a CSS value</a> to return <code>null</code>.</p>


  <!-- ........................................................................................................................ -->

  <h4 id="serializing-css-values"><span class="secno">6.6.2 </span>Serializing CSS Values</h4>

  <!-- based on http://damowmow.com/playground/canon.txt -->

  <p>To <dfn id="serialize-a-css-value">serialize a CSS value</dfn> follow
  these rules:</p>

  <ul>
   <li><p><a href="#serialize-a-css-value-component" title="Serialize a CSS component value">Serialize</a> any
   CSS component values in the value.</li>

   <li><p>Where multiple CSS component values can appear in any order
   without changing the meaning of the value (typically represented by a
   double bar <code>||</code> in the value syntax), use the order as given
   in the syntax.</li>
   <!-- <code>&lt;border-width> &lt;border-style> &lt;color></code>
   for <code>border</code> -->

   <li>
    <p>Where CSS component values of the value can be omitted without
    changing the meaning of the value (e.g. initial values in shorthand
    properties), omit them. If this would remove all the values, then
    include the first allowed value.</p>

    <p class="example">E.g. <code>margin: 20px 20px</code> becomes
    <code>margin: 20px</code>.</p>

    <p class="example">E.g. the value <code>0</code> for the
    '<code>border</code>' property.</p>
   </li>

   <li><p>If the value of a shorthand property is requested and it cannot be
   computed because the properties associated with the shorthand have values
   that cannot be represented by the shorthand the serialization is the
   empty string.</li>

   <li><p>If a value has a <a href="#whitespace">whitespace</a>-separated list of
   CSS component values,
   <a href="#serialize-a-whitespace-separated-list" title="serialize a whitespace-separated list">serialize</a> the
   value as a whitespace-separated list.</li>

   <li><p>If a value has a comma-separated list of
   CSS component values,
   <a href="#serialize-a-comma-separated-list" title="serialize a comma-separated list">serialize</a> the
   value as a comma-separated list.</li>
  </ul>


  <p>To
  <dfn id="serialize-a-css-value-component">serialize a CSS component value</dfn>
  depends on the component, as follows:</p>

  <dl class="switch">
   <dt>keyword</dt>
   <dd><p>The keyword
   <a class="external" href="http://dom.spec.whatwg.org/#converted-to-ascii-lowercase">converted to ASCII lowercase</a>.</dd>

   <dt>&lt;angle&gt;</dt>
   <dd><p>The number of degrees serialized as per &lt;number&gt; followed by
   the literal string "<code>deg</code>".</dd>

   <dt>&lt;color&gt;</dt>
   <dd>
   <p>If &lt;color&gt; is a component of a resolved or computed value, then
   return the color using the <code>rgb()</code> or <code>rgba()</code> functional
   notation as follows:</p>
   <ol>
   <li>If the alpha component of the color is equal to one, then return the serialization of the
   <code>rgb()</code> functional equivalent of the opaque color.</li>
   <li>If the alpha component of the color is not equal to one, then return the serialization of the
   <code>rgba()</code> functional equivalent of the non-opaque color.</li>
   </ol>
   <p>The serialization of the <code>rgb()</code> functional equivalent is the concatenation of the following:</p>
   <ol>
   <li>The string "<code>rgb(</code>".</li>
   <li>The shortest base-ten integer serialization of the color's red component.</li>
   <li>The string "<code>, </code>".</li>
   <li>The shortest base-ten serialization of the color's green component.</li>
   <li>The string "<code>, </code>".</li>
   <li>The shortest base-ten serialization of the color's blue component.</li>
   <li>The string "<code>)</code>".</li>
   </ol>
   <p>The serialization of the <code>rgba()</code> functional equivalent is the concatenation of the following:</p>
   <ol>
   <li>The string "<code>rgba(</code>".</li>
   <li>The shortest base-ten serialization of the color's red component.</li>
   <li>The string "<code>, </code>".</li>
   <li>The shortest base-ten serialization of the color's green component.</li>
   <li>The string "<code>, </code>".</li>
   <li>The shortest base-ten serialization of the color's blue component.</li>
   <li>The string "<code>, </code>".</li>
   <li>The shortest serialization of the &lt;number&gt; that denotes the color's alpha component.</li>
   <li>The string "<code>)</code>".</li>
   </ol>

   <p>In the above rules, the string "<code>, </code>" denotes a COMMA (U+002C) followed by a single SPACE (U+0020).</p>

   <p>If &lt;color&gt; is a component of a specified value, then
   return the color as follows:</p>
   <ol>
   <li>If the color was explicitly specified by the author, then return the original, author specified color value.</li>
   <li>Otherwise, return the value that would be returned if the color were a component of a computed value.</li>
   </ol>
   <p class="issue">Should author specified values be normalized for case? Or should original case be preserved?</p>
   </dd>
   <!--
     <dt>It is a system color</dt>

     <dd>See below (you use the representation given in the specification that
     defines the keyword).</dd>

     <dt>Alpha component is equal to 1.0</dt>

     <dd>The color is an uppercase six-digit hexadecimal value, prefixed with a
     <code>#</code> character (U+0023 NUMBER SIGN), with the first two digits
     representing the red component, the next two digits representing the green
     component, and the last two digits representing the blue component, the
     digits being in the range 0-9 A-F (U+0030 to U+0039 and U+0041 to
     U+0046).</dd>

     <dt>Alpha component is less than 1.0</dt>

     <dd>The color is in the CSS <code>rgba()</code> functional-notation format:
     the literal string <code>rgba</code> (U+0072 U+0067 U+0062 U+0061) followed
     by a U+0028 LEFT PARENTHESIS, a <span>color component integer</span>
     representing the red component, a <span>color component separator</span>, a
     <span>color component integer</span> for the green component, a <span>color
     component separator</span>, a <span>color component integer</span> for the
     blue component, another <span>color component separator</span> a U+0030
     DIGIT ZERO, a U+002E FULL STOP (representing the decimal point), one or
     more digits in the range 0-9 (U+0030 to U+0039) representing the fractional
     part of the alpha value, and finally a U+0029 RIGHT PARENTHESIS.</dd>

     <dt>The keyword <code>transparent</code> is used</dt>

     <dd>The color is <code>rgba(0, 0, 0, 0)</code>.</dd>
   -->

   <dt>&lt;counter&gt;</dt>
   <dd>
    <p>The concatenation of:</p>
    <ol>
     <li><p>If &lt;counter&gt; has three CSS component values the string
     "<code>counters(</code>".</li>
     <li><p>If &lt;counter&gt; has two CSS component values the string
     "<code>counter(</code>".</li>
     <li><p>The result of
     <a href="#serialize-a-comma-separated-list" title="serialize a comma-separated list">serializing</a> the
     <a href="#serialize-a-css-value-component" title="serialize a CSS component value">serialized</a>
     CSS component values belonging to &lt;counter&gt; as list while omitting
     the last CSS component value if it is 'decimal'.</li>
     <li><p>"<code>)</code>" (U+0029).</li>
    </ol>
   </dd>

   <dt>&lt;frequency&gt;</dt>
   <dd><p>The frequency in hertz serialized as per &lt;number&gt; followed by
   the literal string "<code>hz</code>".</dd>

   <dt>&lt;identifier&gt;</dt>
   <dd><p>The identifier
   <a href="#serialize-an-identifier" title="serialize an identifier">escaped</a>.</dd>

   <dt>&lt;integer&gt;</dt>
   <dd><p>A base-ten integer using digits 0-9 (U+0030 to U+0039) in the
   shortest form possible, preceded by "<code>-</code>" (U+002D) if it is
   negative.</dd>

   <dt>&lt;length&gt;</dt>
   <dd>
    <p>A length of zero is represented by the literal string
    "<code>0px</code>".</p>

    <p>Absolute lengths: the number of millimeters serialized as per
    &lt;number&gt; followed by the literal string "<code>mm</code>".</p>
    <p class="issue">Rumor has it absolute lengths will become relative
    lengths. Centimeters would be compatible with &lt;resolution&gt;...</p>

    <p>Relative lengths: the &lt;number&gt; component serialized as per
    &lt;number&gt; followed by the unit in its canonical form as defined in its
    respective specification.</p>
   </dd>

   <dt>&lt;number&gt;</dt>
   <dd><p class="issue">Browsers seem to use ToString(), but that might give a
   significand which according to some is teh evil (and also currently does
   not parse correctly).</dd>

   <dt>&lt;percentage&gt;</dt>
   <dd><p>The &lt;number&gt; component serialized as per &lt;number&gt; followed
   by the literal string "<code>%</code>" (U+0025).</dd>

   <dt>&lt;resolution&gt;</dt>
   <dd><p>The resolution in dots per centimeter serialized as per
   &lt;number&gt; followed by the literal string "<code>dpcm</code>".</dd>

   <dt>&lt;shape&gt;</dt>
   <dd><p>The string "<code>rect(</code>", followed by the result
   of <a href="#serialize-a-comma-separated-list" title="serialize a comma-separated list">serializing</a> the
   <a href="#serialize-a-css-value-component" title="serialize a CSS component value">serialized</a>
   CSS component values belonging to &lt;shape&gt; as list, followed by
   "<code>)</code>" (U+0029).</dd>

   <dt>&lt;string&gt;</dt>
   <dt>&lt;family-name&gt;</dt>
   <dt>&lt;specific-voice&gt;</dt>
   <dd><p>The string
   <a href="#serialize-a-string" title="serialize a string">string escaped</a>.</dd>

   <dt>&lt;time&gt;</dt>
   <dd><p>The time in seconds serialized as per &lt;number&gt; followed by
   the literal string "<code>s</code>".</dd>

   <dt>&lt;uri&gt;</dt>
   <dd><p>The <a class="external" href="http://dev.w3.org/html5/spec/single-page.html#absolute-url">absolute URL</a>
   <a href="#serialize-a-url" title="serialize a URL">URL escaped</a>.</dd>
  </dl>

  <p>
   &lt;absolute-size&gt;,
   &lt;border-width&gt;,
   &lt;border-style&gt;,
   &lt;bottom&gt;,
   &lt;generic-family&gt;,
   &lt;generic-voice&gt;,
   &lt;left&gt;,
   &lt;margin-width&gt;,
   &lt;padding-width&gt;,
   &lt;relative-size&gt;,
   &lt;right&gt;, and
   &lt;top&gt;,
   are considered macros by this specification. They all represent instances
   of components outlined above.</p>

  <p class="issue">One idea is that we can remove this section somewhere in
  the CSS3/CSS4 timeline by moving the above definitions to the drafts that
  define the CSS components.</p>


  <h5 id="examples-0"><span class="secno">6.6.2.1 </span>Examples</h5>

  <p>Here are some examples of before and after results on specified values.
  The before column could be what the author wrote in a style sheet, while
  the after column shows what querying the DOM would return.</p>

  <div class="example">
   <table>
    <thead>
     <tr><th>Before<th>After
    <tbody>
     <tr><td><code>background: none</code><td><code>background: rgba(0, 0, 0, 0)</code>
     <tr><td><code>outline: none</code><td><code>outline: invert</code>
     <tr><td><code>border: none</code><td><code>border: medium</code>
     <tr><td><code>list-style: none</code><td><code>list-style: disc</code>
     <tr><td><code>margin: 0 1px 1px 1px</code><td><code>margin: 0px 1px 1px</code>
     <tr><td><code>azimuth: behind left</code><td><code>azimuth: 220deg</code>
     <tr><td><code>font-family: a, 'b"', serif</code><td><code>font-family: "a", "b\"", serif</code>
     <tr><td><code>content: url('h)i') '\[\]'</code><td><code>content: url("h)i") "[]"</code>
     <tr><td><code>azimuth: leftwards</code><td><code>azimuth: leftwards</code>
     <tr><td><code>color: rgb(18, 52, 86)</code><td><code>color: #123456</code>
     <tr><td><code>color: rgba(000001, 0, 0, 1)</code><td><code>color: #000000</code>
   </table>

   <p class="issue">Some of these need to be updated per the new rules.</p>
  </div>

  <!-- ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->

  <h2 id="dom-access-to-css-declaration-blocks"><span class="secno">7 </span>DOM Access to CSS Declaration Blocks</h2>

  <!-- ........................................................................................................................ -->
  <!-- ........................................................................................................................ -->

  <h3 id="the-elementcssinlinestyle-interface"><span class="secno">7.1 </span>The <code>ElementCSSInlineStyle</code> Interface</h3>

  The <code>ElementCSSInlineStyle</code> interface is implemented by <code>Element</code> objects in order to provide access to inline style properties.
<pre class="idl"><span class="idlInterface" id="widl-def-ElementCSSInlineStyle">[NoInterfaceObject]
interface <span class="idlInterfaceID">ElementCSSInlineStyle</span> {
<span class="idlAttribute">    readonly attribute <span class="idlAttrType"><a>CSSStyleDeclaration</a></span> <span class="idlAttrName"><a href="#widl-ElementCSSInlineStyle-style">style</a></span>;</span>
};</span></pre>
<dl class="attributes">
<dt class="attribute" id="widl-ElementCSSInlineStyle-style">
<code>style</code> of type <span class="idlAttrType"><a>CSSStyleDeclaration</a></span>, readonly</dt>
<dd>
The <code>style</code> attribute must return a mutable <code>CSSStyleDeclaration</code> object    that represents the inline style properties of the associated <code>Element</code> instance.</dd>
</dl>


  <!-- ........................................................................................................................ -->
  <!-- ........................................................................................................................ -->

  <h3 id="extensions-to-the-window-interface"><span class="secno">7.2 </span>Extensions to the <code>Window</code> Interface</h3>

  
<pre class="idl"><span class="idlInterface" id="widl-def-Window">partial interface <span class="idlInterfaceID">Window</span> {
<span class="idlMethod">    <span class="idlMethType"><a>CSSStyleDeclaration</a></span> <span class="idlMethName"><a href="#widl-Window-getComputedStyle-CSSStyleDeclaration-Element-elt">getComputedStyle</a></span> (<span class="idlParam"><span class="idlParamType"><a>Element</a></span> <span class="idlParamName">elt</span></span>);</span>
<span class="idlMethod">    <span class="idlMethType"><a>CSSStyleDeclaration</a></span> <span class="idlMethName"><a href="#widl-Window-getComputedStyle-CSSStyleDeclaration-Element-elt-DOMString-pseudoElt">getComputedStyle</a></span> (<span class="idlParam"><span class="idlParamType"><a>Element</a></span> <span class="idlParamName">elt</span></span>, <span class="idlParam"><span class="idlParamType"><a>DOMString</a></span> <span class="idlParamName">pseudoElt</span></span>);</span>
};</span></pre>
<dl class="methods">
<dt class="method" id="widl-Window-getComputedStyle-CSSStyleDeclaration-Element-elt">
<code>getComputedStyle</code> (<span class="idlParam"><span class="idlParamType"><a>Element</a></span> <span class="idlParamName">elt</span></span>), returns <span class="idlMethType"><a>CSSStyleDeclaration</a></span></dt>
<dt class="method" id="widl-Window-getComputedStyle-CSSStyleDeclaration-Element-elt-DOMString-pseudoElt">
<code>getComputedStyle</code> (<span class="idlParam"><span class="idlParamType"><a>Element</a></span> <span class="idlParamName">elt</span></span>, <span class="idlParam"><span class="idlParamType"><a>DOMString</a></span> <span class="idlParamName">pseudoElt</span></span>), returns <span class="idlMethType"><a>CSSStyleDeclaration</a></span></dt>
<dd>
<p>The <code>getComputedStyle</code> operation must run these steps:</p>    <ol>      <li><p>Let <var>doc</var> be the      <code class="external"><a href="http://dom.spec.whatwg.org/#document">Document</a></code>      associated with the <code class="external"><a href="http://dev.w3.org/html5/spec/single-page.html#window">Window</a></code> object on      which the method was invoked.</li>      <li><p>Let <var>obj</var> be <var>elt</var>.</li>      <li><p>If <var>pseudoElt</var> is as an      <a class="external" href="http://dom.spec.whatwg.org/#ascii-case-insensitive">ASCII case-insensitive</a> match for      either '<code>:before</code>' or '<code>::before</code>' let      <var>obj</var> be the '::before' pseudo-element of      <var>elt</var>.</li>      <li><p>If <var>pseudoElt</var> is as an      <a class="external" href="http://dom.spec.whatwg.org/#ascii-case-insensitive">ASCII case-insensitive</a> match for      either '<code>:after</code>' or '<code>::after</code>' let      <var>obj</var> be the '::after' pseudo-element of      <var>elt</var>.</li>      <li>       <p>Return a <a href="#css-declaration-block">CSS declaration block</a> with the       <a href="#css-declaration-block-readonly-flag">CSS declaration block readonly flag</a> set and the       <a href="#css-declaration-block-declarations">CSS declaration block declarations</a> set to all properties       the user agent supports with as value the <a href="#resolved-value">resolved value</a>       computed for <var>obj</var> using the style rules associated       with <var>doc</var>.</p>       <p class="note">This means that even if <var>obj</var> is in a       different document (e.g. one fetched via <code>XMLHttpRequest</code>) it       will still use the style rules associated with the document that is       associated with the global object on which       <code title="dom-Window-getComputedStyle">getComputedStyle()</code> was       invoked to compute the <a href="#css-declaration-block">CSS declaration block</a>.</p>      </li>    </ol>    <p class="note">Because of historical IDL limitations the <code>getComputedStyle</code> operation used to be on    a separate interface, <code>ViewCSS</code>.</dd>
</dl>


  <!-- ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->

  <h2 id="resolved-values"><span class="secno">8 </span>Resolved Values</h2>

  <p><code title="dom-Window-getComputedStyle">getComputedStyle()</code> was
  historically defined to return the "computed value" of an element or
  pseudo-element. However, the concept of "computed value" changed between
  revisions of CSS while the implementation of
  <code title="dom-Window-getComputedStyle">getComputedStyle()</code> had to
  remain the same for compatibility with deployed scripts. To address this
  issue this specification introduces the concept of a
  <dfn id="resolved-value">resolved value</dfn>.</p>

  <p>The <a href="#resolved-value">resolved value</a> for a given property can be determined
  as follows:</p>

  <dl class="switch">
   <!--
   We want to treat shorthand properties like any other value basically.

   <dt>'<code>background</code>'
   <dt>'<code>border</code>'
   <dt>'<code>border-collapse</code>'
   <dt>'<code>border-color</code>'
   <dt>'<code>border-spacing</code>'
   <dt>'<code>border-style</code>'
   <dt>'<code>border-top</code>'
   <dt>'<code>border-right</code>'
   <dt>'<code>border-bottom</code>'
   <dt>'<code>border-left</code>'
   <dt>'<code>border-width</code>'
   <dt>'<code>font</code>'
   <dt>'<code>list-style</code>'
   <dt>'<code>margin</code>'
   <dt>'<code>outline</code>'
   <!- - overflow is not - ->
   <dt>'<code>padding</code>'
   <dt>'<code>pause</code>'
   <dd>
    <p>There is no <span>resolved value</span>.</p>
   </dd>
   -->

   <dt>'<code>line-height</code>'</dt>
   <dd><p>The <a href="#resolved-value">resolved value</a> is the used value.</dd>

   <dt>'<code>height</code>'</dt>
   <dt>'<code>margin</code>'</dt>
   <dt>'<code>margin-bottom</code>'</dt>
   <dt>'<code>margin-left</code>'</dt>
   <dt>'<code>margin-right</code>'</dt>
   <dt>'<code>margin-top</code>'</dt>
   <dt>'<code>padding</code>'</dt>
   <dt>'<code>padding-bottom</code>'</dt>
   <dt>'<code>padding-left</code>'</dt>
   <dt>'<code>padding-right</code>'</dt>
   <dt>'<code>padding-top</code>'</dt>
   <dt>'<code>width</code>'</dt>
   <dd><p>If the property applies to the element or pseudo-element and the
   <a href="#resolved-value">resolved value</a> of the '<code>display</code>' property is not
   <code>none</code>, the <a href="#resolved-value">resolved value</a> is the
   <span>used value</span>. Otherwise the <a href="#resolved-value">resolved value</a> is the
   computed value.</dd>

   <dt>'<code>bottom</code>'</dt>
   <dt>'<code>left</code>'</dt>
   <dt>'<code>right</code>'</dt>
   <dt>'<code>top</code>'</dt>
   <dd><p>If the property applies to a positioned element and the
   <a href="#resolved-value">resolved value</a> of the '<code>display</code>' property is not
   <code>none</code>, the <a href="#resolved-value">resolved value</a> is the
   <span>used value</span>. Otherwise the <a href="#resolved-value">resolved value</a> is the
   computed value.</dd>

   <dt>Any other property</dt>
   <dd><p>The <a href="#resolved-value">resolved value</a> is the computed value.</dd>
  </dl>

  <!-- ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->

  <h2 id="iana-considerations"><span class="secno">9 </span>IANA Considerations</h2>

  <!-- ........................................................................................................................ -->
  <!-- ........................................................................................................................ -->

  <h3 id="default-style"><span class="secno">9.1 </span><dfn title="http-default-style"><code>Default-Style</code></dfn></h3>

  <p>This section describes a header field for registration in the Permanent
  Message Header Field Registry.
  <!--<a href="XXX">[RFC3864]</a>--></p>

  <dl>
   <dt>Header field name</dt>
   <dd>Default-Style</dd>
   <dt>Applicable protocol</dt>
   <dd>http</dd>
   <dt>Status</dt>
   <dd>standard</dd>
   <dt>Author/Change controller</dt>
   <dd>W3C</dd>
   <dt>Specification document(s)</dt>
   <dd>This document is the relevant specification.</dd>
   <dt>Related information</dt>
   <dd>None.</dd>
  </dl>

  <!-- ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->

  <h2 class="no-num" id="references">References</h2>

  <!-- ........................................................................................................................ -->
  <!-- ........................................................................................................................ -->

  <h3 class="no-num" id="normative-references">Normative references</h3>
  <div id="anolis-references-normative"><dl><dt id="refsCSS">[CSS]
<dd><cite><a href="http://www.w3.org/TR/CSS2/">CSS</a></cite>, Bert Bos, Tantek Çelik, Ian Hickson et al.. W3C.

<dt id="refsDOM">[DOM]
<dd><cite><a href="http://dom.spec.whatwg.org/">DOM</a></cite>, Anne van Kesteren, Aryeh Gregor and Ms2ger. WHATWG.

<dt id="refsDOM2STYLE">[DOM2STYLE]
<dd><cite><a href="http://www.w3.org/TR/DOM-Level-2-Style/">Document Object Model (DOM) Level 2 Style Specification</a></cite>, Chris Wilson, Philippe Le Hégaret and Vidur Apparao. W3C.

<dt id="refsHTML">[HTML]
<dd><cite><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/">HTML</a></cite>, Ian Hickson. WHATWG.

<dt id="refsRFC2119">[RFC2119]
<dd><cite><a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a></cite>, Scott Bradner. IETF.

<dt id="refsXML">[XML]
<dd><cite><a href="http://www.w3.org/TR/xml/">Extensible Markup Language</a></cite>, Tim Bray, Jean Paoli, C. M. Sperberg-McQueen et al.. W3C.

<dt id="refsXMLSS">[XMLSS]
<dd><cite><a href="http://www.w3.org/TR/xml-stylesheet/">Associating Style Sheets with XML documents 1.0 (Second Edition)</a></cite>, James Clark, Simon Pieters and Henry S. Thompson. W3C.

</dl></div>

  <!-- ........................................................................................................................ -->
  <!-- ........................................................................................................................ -->

  <h3 class="no-num" id="informative-references">Informative references</h3>
  <div id="anolis-references-informative"></div>

  <!-- ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->

  <h2 class="no-num" id="changes">Change History</h2>

  <p>This section documents the primary technical changes of CSSOM related functionality, with a focus on changes to API signatures.</p>

  <h3 class="no-num" id="changes-from-dom2">Changes From DOM-2 Style</h3>

  <ul>
  <li><p>Remove definition of <code>CSSRule.UNKNOWN_RULE</code>, reserving its value (0) to prevent future reuse.</li>
  <li><p>Remove definition of <code>DOMImplementationCSS</code> interface.</li>
  </ul>

  <!-- ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->

  <h2 class="no-num" id="acknowledgments">Acknowledgments</h2>

  <p>The editors would like to thank

  Alexey Feldgendler,
  Björn Höhrmann,
  Boris Zbasky,
  Brian Kardell,
  Christian Krebs,
  Daniel Glazman,
  David Baron,
  <i>fantasai</i>,
  Hallvord R. M. Steen,
  Ian Hickson,
  John Daggett,
  Lachlan Hunt,
  Morten Stenshorne,
  Philip Taylor,
  Robert O'Callahan,
  Sjoerd Visscher,
  Simon Pieters,
  Sylvain Galineau,
  Tarquin Wilton-Jones, and
  Zack Weinberg

  for contributing to this specification.</p>

  <p>Additional thanks to Ian Hickson for writing the
  initial version of the alternative style sheets API and canonicalization
  (now serialization) rules for CSS values.</p>

  <!-- XXX NOTES

  <style type=text/css;charset=utf-8> does create a StyleSheet in Firefox
  and Opera, but does not create a StyleSheet in IE. I prefer IE.

  <style type=TEXT/CSS> sets the style sheet type to text/css in Firefox and
  TEXT/CSS in Opera and IE. I prefer Firefox.

  <style> sets the style sheet location to the document location Firefox,
  the empty string in IE, and null in Opera. I prefer Opera

  <style media="x"> invokes .sheet.media.mediaText = "x"

  <style> does not "have" a title

  .cascadedStyle that returns less keywords than currentStyle, no inherit,
  etc.

  Markup style: http://krijnhoetmer.nl/irc-logs/whatwg/20100204#l-529
  -->
 




